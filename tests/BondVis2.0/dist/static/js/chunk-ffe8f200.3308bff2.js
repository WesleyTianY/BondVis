(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ffe8f200"],{1281:function(t,e,a){},"1ca4":function(t,e,a){},"234b":function(t,e,a){},"316b":function(t,e,a){"use strict";a("1281")},"3eb4":function(t,e,a){},"42bf":function(t,e,a){},4751:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"dashboard-container",staticStyle:{width:"1800px",padding:"0 0"}},[a("div",{staticStyle:{height:"80%"}},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-sm-2",staticStyle:{padding:"0 0"}},[a("MacroView",{attrs:{end_date:t.end_date,duration_days:t.duration_days},on:{"data-loaded":t.handleDataLoaded}})],1),a("div",{staticClass:"col-sm-8",staticStyle:{padding:"0 0"}},[a("div",{staticClass:"col"},[a("div",{staticClass:"row-sm-2",staticStyle:{padding:"0 0"}},[a("MesoView",{attrs:{selected_bond_list:t.selected_bond_list,end_date:t.end_date,duration_days:t.duration_days}})],1)])]),a("div",{staticClass:"col-sm-2",staticStyle:{padding:"0 0"}},[a("RecordView",{attrs:{end_date:t.end_date,duration_days:t.duration_days}})],1)])])])},r=[],i=a("5530"),o=(a("4de4"),a("caad"),a("d3b7"),a("2532"),a("2f62")),s=a("7084"),c=a("0942"),l=a("205f"),d=a("b885"),u=a("6197"),h=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("b-card",{staticStyle:{height:"100%"},attrs:{"no-body":""}},[a("b-card-header",{staticClass:"large-header",staticStyle:{height:"230px",padding:"5px 20px 0px 20px"}},[a("div",{staticStyle:{display:"flex","margin-top":"10px"}},[a("span",{staticStyle:{"font-size":"15px"}},[a("b",[t._v("Bond List View")])]),a("b-dropdown",{staticStyle:{"margin-left":"20px",height:"15px",display:"flex","align-items":"center"},attrs:{dropright:"",size:"sm",variant:"outline-secondary","toggle-class":"text-decoration-none"},scopedSlots:t._u([{key:"button-content",fn:function(){return[a("b-icon-gear",{staticStyle:{"font-size":"12px",height:"16px",width:"20px"}})]},proxy:!0}])},[a("div",{staticStyle:{width:"150px","margin-left":"10px","font-size":"12px"}},[t._v(" Bond price Threshold1 "),a("vue-slider",{staticStyle:{"margin-left":"20px","margin-right":"10px","margin-bottom":"30px"},attrs:{min:1,max:4,interval:.5,marks:!0},model:{value:t.Threshold_local,callback:function(e){t.Threshold_local=e},expression:"Threshold_local"}})],1)])],1),a("div",{staticStyle:{display:"flex","margin-top":"10px",float:"left"}},[a("el-date-picker",{attrs:{type:"date",placeholder:"Pick a day"},model:{value:t.date,callback:function(e){t.date=e},expression:"date"}}),a("button",{staticClass:"btn btn-secondary button",staticStyle:{"margin-right":"10px"},on:{click:function(e){return t.timeClick(t.date)}}},[t._v(" OK ")])],1),a("div",{staticStyle:{display:"flex","margin-top":"10px",float:"left"}},[a("span",{staticStyle:{"font-size":"12px"}},[t._v("Trans num")]),a("vue-slider",{staticStyle:{width:"150px","margin-left":"20px"},attrs:{adsorb:!0,data:t.transaction_num_range_list,included:!0},model:{value:t.transaction_num_range,callback:function(e){t.transaction_num_range=e},expression:"transaction_num_range"}})],1),a("div",{staticStyle:{display:"flex","margin-top":"10px",float:"left"}},[a("span",{staticStyle:{"margin-top":"5px"}},[t._v("Sort by number")]),a("b-button-group",{staticStyle:{"margin-left":"10px",float:"right"},attrs:{size:"sm"}},[a("b-button",{staticStyle:{"font-size":"12px",height:"25px","margin-left":"24px",float:"right"},attrs:{variant:"outline-secondary"},on:{click:function(e){return t.updateNumSort("num_descending")}}},[a("b-icon-arrow-down")],1),a("b-button",{staticStyle:{"font-size":"12px",height:"25px"},attrs:{variant:"outline-secondary"},on:{click:function(e){return t.updateNumSort("num_ascending")}}},[a("b-icon-arrow-up")],1)],1)],1),a("div",{staticStyle:{display:"flex","margin-top":"10px",float:"left"}},[a("span",{staticStyle:{"font-size":"12px",float:"left"}},[t._v("Trans vol")]),a("vue-slider",{staticStyle:{width:"150px","margin-left":"27px"},attrs:{adsorb:!0,data:t.transaction_volume_range_list,included:!0},model:{value:t.transaction_volume_range,callback:function(e){t.transaction_volume_range=e},expression:"transaction_volume_range"}})],1),a("div",{staticStyle:{display:"flex","margin-top":"10px",float:"left"}},[a("span",{staticStyle:{"margin-top":"5px"}},[t._v("Sort by volume")]),a("b-button-group",{staticStyle:{"margin-left":"10px",float:"right"},attrs:{size:"sm"}},[a("b-button",{staticStyle:{"font-size":"12px",height:"25px","margin-left":"24px",float:"right"},attrs:{variant:"outline-secondary"},on:{click:function(e){return t.updateVolSort("vol_descending")}}},[a("b-icon-arrow-down")],1),a("b-button",{staticStyle:{"font-size":"12px",height:"25px"},attrs:{variant:"outline-secondary"},on:{click:function(e){return t.updateVolSort("vol_ascending")}}},[a("b-icon-arrow-up")],1)],1)],1)]),a("b-card-body",{staticStyle:{overflow:"scroll",height:"570px",padding:"2px"}},[a("div",{staticStyle:{display:"flex","flex-direction":"column"}},[a("div",{staticStyle:{flex:"1"}},[a("div",{staticStyle:{display:"block",height:"20px","margin-top":"0px",float:"right"}},[a("b-input-group",{staticStyle:{width:"278px"},attrs:{size:"sm"},scopedSlots:t._u([{key:"append",fn:function(){return[a("b-input-group-text",{staticStyle:{float:"right"}},[a("svg",{staticClass:"bi bi-search",attrs:{width:"16",height:"16",fill:"currentColor",viewBox:"0 0 16 16"}},[a("path",{attrs:{d:"M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"}})])])]},proxy:!0}])},[a("b-form-input",{attrs:{placeholder:"Search by Name or ID"},model:{value:t.searchQuery,callback:function(e){t.searchQuery=e},expression:"searchQuery"}})],1)],1)]),a("div",{staticStyle:{flex:"1","margin-top":"13px"}},[t.marcoDataLoaded?a("div",[a("div",{staticStyle:{"font-size":"12px"}},[t._v("Transaction Num Range: "+t._s(t.transaction_num_range[0])+" - "+t._s(t.transaction_num_range[1]))]),a("div",{staticStyle:{"font-size":"12px"}},[t._v("Transaction Volume Range: "+t._s(t.transaction_volume_range[0])+" - "+t._s(t.transaction_volume_range[1]))]),a("div",{staticStyle:{"font-size":"12px"}},[t._v("Filtered Projects Count: "+t._s(t.filteredAndSortedProjects.length))]),t._l(t.filteredAndSortedProjects,(function(e){return a("MarcoCard",{key:e.Bond_cd,attrs:{bond_cd:e.Bond_cd,bond_name:e.Bond_name,transaction_num:e.Transaction_num,transaction_volume:e.Transaction_volume,duration_days:t.duration_days,end_date:t.end_date}})}))],2):t._e()])])])],1)],1)},m=[],p=a("2909"),f=(a("d81d"),a("fb6a"),a("4e82"),a("25f0"),a("f9e3"),a("2dd8"),a("4971")),g=a.n(f),b=(a("24df"),a("bc3a")),y=a.n(b),v=a("0759"),S=a("7386"),D=a("1947"),x=a("d0b9"),w=a("dd9a"),k=a("3734"),B=a("9eaa"),T=a("a17a"),C=a("5e12"),I=a("d190"),M=a("4797"),j=a("12aa"),O=a("404b"),V=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("b-card",{attrs:{"no-body":""}},[a("b-card-header",{staticClass:"small-header",staticStyle:{"font-size":"12px",padding:"2px 2px",height:"26px"}},[t._v(" "+t._s(t.bond_cd)+" "),a("b",[t._v("Num:")]),t._v(" "+t._s(t.transaction_num)+" "),a("b",[t._v("Name:")]),t._v(" "+t._s(t.bond_name)+" "),t.selected?t._e():a("b-button",{staticStyle:{float:"right",padding:"0"},attrs:{size:"sm",variant:"outline"},on:{click:t.onClick}},[a("b-icon-plus-square")],1),t.selected?a("b-button",{staticStyle:{float:"right",padding:"0"},attrs:{size:"sm",variant:"outline"},on:{click:t.onClick}},[a("b-icon-dash-square")],1):t._e()],1),a("b-card-body",{staticStyle:{padding:"2px"},attrs:{id:"mg_"+t.bond_cd}},[a("MarcoGlyph",{attrs:{bond_cd:t.bond_cd,end_date:t.end_date,duration_days:t.duration_days}})],1)],1)},L=[],Z=a("5698"),P=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("svg",{staticStyle:{width:"100%",height:"40px"},attrs:{id:"svg_marcoGlyph_"+t.bond_cd+"_"+t.end_date+"_"+t.duration_days,end_date:t.end_date,duration_days:t.duration_days}})},A=[],H=a("c7eb"),G=a("1da1"),R=a("3835"),z=a("d4ec"),E=a("bee2"),N=(a("99af"),a("13d5"),a("4fad"),a("b64b"),a("07ac"),a("4d90"),a("159b"),a("96eb")),F=a.n(N),$=a("b166"),W=function(){function t(){Object(z["a"])(this,t),this.dataPackage={mktPrice:[],transaction:[],valuation:[],volume:[],gradient:[],mktPriceTrue:[]}}return Object(E["a"])(t,[{key:"generateData",value:function(){var t=Object(G["a"])(Object(H["a"])().mark((function t(e,a,n){var r,i,o,s;return Object(H["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.getMarketPriceData(e);case 3:return r=t.sent,t.next=6,this.getTransactionData(e);case 6:return i=t.sent,t.next=9,this.getTransactionData(e);case 9:return o=t.sent,t.next=12,this.getTransactionData(e);case 12:s=t.sent,this.dataPackage.mktPrice=r,this.dataPackage.transaction=i,this.dataPackage.valuation=o,this.dataPackage.volume=s,t.next=22;break;case 19:t.prev=19,t.t0=t["catch"](0),console.error("Error generating data:",t.t0);case 22:case"end":return t.stop()}}),t,this,[[0,19]])})));function e(e,a,n){return t.apply(this,arguments)}return e}()},{key:"getMarketPriceData",value:function(){var t=Object(G["a"])(Object(H["a"])().mark((function t(e){var a,n;return Object(H["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,y.a.get("http://localhost:5003/api/BasicData_MarketPrice/".concat(e));case 3:return a=t.sent,n=a.data.filtered_json_mkt,t.abrupt("return",n);case 8:return t.prev=8,t.t0=t["catch"](0),console.error("Error fetching market price data:",t.t0),t.abrupt("return",[]);case 12:case"end":return t.stop()}}),t,null,[[0,8]])})));function e(e){return t.apply(this,arguments)}return e}()},{key:"getTransactionData",value:function(){var t=Object(G["a"])(Object(H["a"])().mark((function t(e){var a,n;return Object(H["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,y.a.get("http://localhost:5003/api/BasicData_transaction/".concat(e));case 3:return a=t.sent,n=a.data.filtered_json_transaction,t.abrupt("return",n);case 8:return t.prev=8,t.t0=t["catch"](0),console.error("Error fetching market price data:",t.t0),t.abrupt("return",[]);case 12:case"end":return t.stop()}}),t,null,[[0,8]])})));function e(e){return t.apply(this,arguments)}return e}()},{key:"updatedata",value:function(t){var e=t.mktPrice_flask,a=t.transaction_flask;return e.then((function(e){t.mktPrice=e,console.log("mktPrice_flask parsedDate",e)})),a.then((function(e){t.transaction=e,console.log("transaction_flask parsedDate",e)})),console.log("parsedDate dataPackage:",t),t}},{key:"generateMarketPriceData",value:function(t,e,a){for(var n=[],r=a;r>=0;r--)for(var i=F.a.Random.integer(40,60),o=1;o<=i;o++){var s={bond_cd:t,netValue:F.a.Random.float(90,110,2,2),tradeVolume:F.a.Random.integer(10,1e3),timeStamp:this._randomDateInRange(e,r).toLocaleString()};n.push(s)}return n}},{key:"generateTransactionData",value:function(t,e,a){for(var n=[],r=a;r>=0;r--)for(var i=F.a.Random.integer(40,60),o=1;o<=i;o++){var s={bond_cd:t,transactionId:F.a.Random.string("upper",3,7),netPrice:F.a.Random.float(95,105,0,2),transactionVolume:F.a.Random.float(10,400),tradeResult:F.a.Random.boolean(),timeStamp:this._randomDateInRange(e,r).toLocaleString()};n.push(s)}return n}},{key:"generateValuationData",value:function(t,e,a){for(var n=[],r=a;r>0;r--){var i=new Date(e);i.setDate(i.getDate()-r);var o=Object($["a"])(i,"yyyy-MM-dd"),s={bond_cd:t,valuationPrice:F.a.Random.float(98,103,2,2),profitRate:F.a.Random.float(.02,.04,2,2),recommendFlag:F.a.Random.boolean(),timeStamp:o};n.push(s)}return n}},{key:"_randomDateInRange",value:function(t,e){var a=new Date(t+" 09:00:00"),n=new Date,r=new Date;n.setTime(a),r.setTime(a),n.setDate(n.getDate()-e),r.setDate(r.getDate()-e),n.setHours(9,30,0,0),r.setHours(15,0,0,0);var i=n.getTime(),o=r.getTime(),s=F.a.Random.integer(i,o);return new Date(s)}},{key:"generateGradient",value:function(){}},{key:"volumeStatistic",value:function(){}}]),t}(),Y=W,q=a("2ef0"),U=a.n(q),Q=a("6ff4"),J=Q.format,X={props:["bond_cd","end_date","duration_days"],data:function(){return{}},created:function(){},mounted:function(){this.dataPackages=this.fetchData()},methods:{dataPackageGeneration:function(t,e,a){var n=function(){function t(e,a,n){Object(z["a"])(this,t);var r={};r["mktPrice"]=this.generateMarketPriceData(e,a,n),r["transaction"]=this.generateTransactionData(e,a,n),r["valuation"]=this.generateValuationData(e,a,n),r["volume"]=this.generateMarketPriceData(e,a,n),r["gradient"]=this.generateMarketPriceData(e,a,n),this.dataPackage=r}return Object(E["a"])(t,[{key:"generateMarketPriceData",value:function(t,e,a){for(var n=[],r=a;r>=0;r--)for(var i=F.a.Random.integer(40,60),o=1;o<=i;o++){var s={bond_cd:t,netValue:F.a.Random.float(90,110,2,2),tradeVolume:F.a.Random.integer(10,1e3),timeStamp:this._randomDateInRange(e,r).toLocaleString()};n.push(s)}return n}},{key:"generateTransactionData",value:function(t,e,a){for(var n=[],r=a;r>=0;r--)for(var i=F.a.Random.integer(40,60),o=1;o<=i;o++){var s={bond_cd:t,transactionId:F.a.Random.string("upper",3,4),netPrice:F.a.Random.float(95,105,0,2),transactionVolume:F.a.Random.float(10,400),tradeResult:F.a.Random.boolean(),timeStamp:this._randomDateInRange(e,r).toLocaleString()};n.push(s)}return n}},{key:"generateValuationData",value:function(t,e,a){for(var n=[],r=a;r>0;r--){var i=new Date(e);i.setDate(i.getDate()-r);var o=J(i,"yyyy-MM-dd"),s={bond_cd:t,valuationPrice:F.a.Random.float(98,103,2,2),profitRate:F.a.Random.float(.02,.04,2,2),recommendFlag:F.a.Random.boolean(),timeStamp:o};n.push(s)}return n}},{key:"_randomDateInRange",value:function(t,e){var a=new Date(t+" 09:00:00"),n=new Date,r=new Date;n.setTime(a),r.setTime(a),n.setDate(n.getDate()-e),r.setDate(r.getDate()-e),n.setHours(9,30,0,0),r.setHours(15,0,0,0);var i=n.getTime(),o=r.getTime(),s=F.a.Random.integer(i,o);return new Date(s)}},{key:"generateGradient",value:function(){}},{key:"volumeStatistic",value:function(){}}]),t}(),r=new n(t,e,a);return r.dataPackage},drawMultiCharts:function(t,e,a,n,r,i){var o=function(){function t(e,a,n,r,i,o){Object(z["a"])(this,t),this.allData=e,this.bond_cd=a,this.endDay=n,this.duration_days=r,this.margin={top:3,right:3,bottom:3,left:3},this.width=297,this.height=40,this.vueComponent=i,this.upper=o[1],this.lower=o[0];var s=Z["select"]("#svg_marcoGlyph_"+a+"_"+n+"_"+r).append("svg").append("g").attr("width",this.width).attr("height",this.height);this.chartContainer=s;var c=this.chartContainer.append("svg").attr("width",this.width).attr("height",this.height).attr("name","lineContainer");this.lineContainer=c}return Object(E["a"])(t,[{key:"drawMultiDayData",value:function(t){var e=this,a=this.allData[t],n=a.sort((function(t,e){return new Date(t.timeStamp)-new Date(e.timeStamp)})),r=n.reduce((function(t,e){var a=e.timeStamp.substr(0,10);return t[a]||(t[a]=[]),t[a].push(e),t}),{}),i=2*Object.keys(r).length;Object.entries(r).forEach((function(a,n){var r=Object(R["a"])(a,2),o=r[0],s=r[1],c=2*n/i*e.width,l=(2*n+1)/i*e.width,d=e.dataFilter(s,o),u=U.a.cloneDeep(d),h=u[0].AM,m=u[0].PM,p=U.a.cloneDeep(h),f=U.a.cloneDeep(m);e.drawDayData(p,t,o,c,"AM",i),e.drawDayData(f,t,o,l,"PM",i)}))}},{key:"drawDayData",value:function(t,e,a,n,r,i){var o=!1,s=!1;switch("AM"===r&&(o=this.offsetTime(a,9,0),s=this.offsetTime(a,12,0)),"PM"===r&&(o=this.offsetTime(a,13,30),s=this.offsetTime(a,17,30)),e){case"mktPrice":this.drawMktPriceLine(t,n,r,o,s,i);break;case"valuation":this.drawValuationLine(t,n,o,s,i);break;case"volume":this.drawVolumeBar(t,n,r,o,s,i);break;case"transaction":this.drawTrasactionScatter(t,n,r,o,s,i);break;case"gradient":this.drawGradTimeline(t,n,o,s,i);break}}},{key:"formatDateToCustomString",value:function(t){var e=new Date(t),a=e.getFullYear(),n=(e.getMonth()+1).toString().padStart(2,"0"),r=e.getDate().toString().padStart(2,"0"),i=e.getHours().toString().padStart(2,"0"),o=e.getMinutes().toString().padStart(2,"0"),s=e.getSeconds().toString().padStart(2,"0"),c="".concat(a,"_").concat(n,"_").concat(r,"_").concat(i,"_").concat(o,"_").concat(s);return c}},{key:"formatDateToCustomDateString",value:function(t){var e=new Date(t),a=e.getFullYear(),n=(e.getMonth()+1).toString().padStart(2,"0"),r=e.getDate().toString().padStart(2,"0"),i=e.getHours().toString().padStart(2,"0"),o=e.getMinutes().toString().padStart(2,"0"),s=e.getSeconds().toString().padStart(2,"0"),c="".concat(a,"-").concat(n,"-").concat(r," ").concat(i,":").concat(o,":").concat(s);return c}},{key:"offsetTime",value:function(t,e,a){var n=new Date(t),r=1e3*(3600*e+60*a),i=n.getTime()+r,o=new Date(i),s=o.getFullYear(),c=(o.getMonth()+1).toString().padStart(2,"0"),l=o.getDate().toString().padStart(2,"0"),d=o.getHours().toString().padStart(2,"0"),u=o.getMinutes().toString().padStart(2,"0"),h=o.getSeconds().toString().padStart(2,"0"),m="".concat(s,"-").concat(c,"-").concat(l,"T").concat(d,":").concat(u,":").concat(h,".000Z");return m}},{key:"drawMktPriceLine",value:function(t,e,a,n,r,i){t.forEach((function(t){var e=t.timeStamp.slice(0,-6);t.timeStamp=e,t.timeStamp=new Date(t.timeStamp)})),t.sort((function(t,e){return t.timeStamp-e.timeStamp})),n=this.formatDateToCustomDateString(n),r=this.formatDateToCustomDateString(r);var o=2*this.width/i*3/7,s=2*this.width/i*4/7;"AM"===a&&(this.theWidth=o),"PM"===a&&(this.theWidth=s);var c=Z["scaleTime"]().range([0,this.width/2]).domain([Z["min"](t,(function(t){return t.timeStamp})),Z["max"](t,(function(t){return t.timeStamp}))]),l=Z["scaleLinear"]().range([this.height,0]).domain([this.lower,this.upper]),d=Z["area"]().x((function(t){return c(t.timeStamp)})).y0(l(0)).y1((function(t){return l(t.netValue)})),u=this.lineContainer.append("g");u.append("path").attr("transform","translate(".concat(e,", 0)")).style("stroke",Z["schemeRdYlBu"][3][2]).style("stroke-width",2).attr("d",d(t)).attr("fill",Z["schemeRdYlBu"][3][2])}},{key:"drawValuationLine",value:function(t,e,a,n){var r=this,i=Z["scaleLinear"]().domain([0,Z["max"](t,(function(t){return t.transactionVolume}))]).range([0,10]);this.chartContainer.selectAll("rect").data(t).enter().append("rect").attr("cx",(function(t,e){return 10*e})).attr("cy",(function(t,e){return r.height-1*t.netPrice})).attr("r",(function(t,e){return i(t.transactionVolume)}))}},{key:"drawTrasactionScatter",value:function(t,e,a,n,r){var i=this;t.forEach((function(t){var e=t.timeStamp.slice(0,-6);t.timeStamp=e,t.timeStamp=new Date(t.timeStamp)})),a=this.formatDateToCustomDateString(a),n=this.formatDateToCustomDateString(n);var o=Z["scaleTime"]().range([0,this.width/r]).domain([Z["min"](t,(function(t){return t.timeStamp})),Z["max"](t,(function(t){return t.timeStamp}))]),s=Z["scaleLinear"]().range([.25*this.height,.95*this.height]).domain([Z["min"](t,(function(t){return t.netPrice})),Z["max"](t,(function(t){return t.netPrice}))]),c=Z["rgb"](255,210,186),l=Z["scaleLinear"]().range([1,5]).domain([Z["min"](t,(function(t){return t.transactionVolume})),Z["max"](t,(function(t){return t.transactionVolume}))]);this.lassoContainer.append("g").attr("stroke","#000").attr("stroke-opacity",.2).selectAll("circle").data(t).enter().append("circle").attr("cx",(function(t){return o(t.timeStamp)})).attr("cy",(function(t){return i.height-s(t.netPrice)})).attr("r",(function(t){return l(t.transactionVolume)})).attr("fill",(function(t){return c})).attr("transform","translate(".concat(e,", 0)")).style("opacity",.6)}},{key:"drawVolumeBar",value:function(t,e,a,n,r){var i=this,o=10,s=this.bucketDataByMinute(t,o);t.forEach((function(t){var e=t.timeStamp.slice(0,-6);t.timeStamp=e,t.timeStamp=new Date(t.timeStamp)})),a=this.formatDateToCustomDateString(a),n=this.formatDateToCustomDateString(n);var c=s.map((function(t){return Z["sum"](t,(function(t){return t.tradeVolume}))})),l=Z["max"](c),d=Z["scaleTime"]().range([0,this.width/r]).domain([Z["min"](t,(function(t){return t.timeStamp})),Z["max"](t,(function(t){return t.timeStamp}))]),u=Z["scaleLinear"]().range([0,.1*this.height]).domain([0,l]);this.VolumeBarContainer.append("g").selectAll("rect").data(s).attr("class","volumeBar").enter().append("rect").attr("x",(function(t){return d(t[0].timeStamp)})).attr("y",(function(t){return.9*i.height-u(Z["sum"](t,(function(t){return t.tradeVolume})))})).attr("height",(function(t){return u(Z["sum"](t,(function(t){return t.tradeVolume})))})).attr("width",this.width/r/(150/o)).attr("fill","SteelBlue").attr("transform","translate(".concat(e,", 0)")).on("mouseover",(function(){Z["select"](this).attr("fill","Maroon")})).on("mouseout",(function(){Z["select"](this).attr("fill","SteelBlue")}))}},{key:"bucketDataByMinute",value:function(t,e){var a={};t.forEach((function(t){var n=new Date(t.timeStamp),r=Math.floor(n.getMinutes()/e)*e;a[r]||(a[r]=[]),a[r].push(t)}));var n=Object.values(a);return n}},{key:"drawGradTimeline",value:function(t,e,a,n,r){var i=10,o=(this.bucketDataByMinute(t,i),Z["timeParse"]("%Y/%m/%d %H:%M:%S"));t.forEach((function(t){t.timeStamp=o(t.timeStamp)})),a=this.formatDateToCustomDateString(a),n=this.formatDateToCustomDateString(n);var s=Z["scaleTime"]().range([0,this.width]).domain([Z["min"](t,(function(t){return t.timeStamp})),Z["max"](t,(function(t){return t.timeStamp}))]),c=Z["timeParse"]("%Y-%m-%dT%H:%M:%S.%LZ");timelineData.forEach((function(t){t.startDate=c(t.startDate),t.endDate=c(t.endDate)})),this.chartContainer.append("g").selectAll("rect").data(timelineData).enter().append("rect").attr("x",(function(t){return s(t.startDate)})).attr("y",this.height-10).attr("width",(function(t){return s(t.endDate)-s(t.startDate)})).attr("height",10).attr("fill","#FFD325").attr("rx",4).attr("stroke","white").style("stroke-width",2).attr("fill","none")}},{key:"generateVirtualFeature",value:function(t,e,a){var n={transactionData:{timeStamp:"timeStamp",netValue:null,tradeVolume:null},valuationData:{timeStamp:"timeStamp",netValue:null,tradeVolume:null,bond_cd:null,valuationPrice:null,profitRate:null,recommendFlag:null}},r=n[a],i={};if(r)for(var o in i["timeStamp"]=t+e.timeStamp,r)"timeStamp"!==o&&(i[o]=r[o]);return i}},{key:"dataFilter",value:function(t,e){var a=[];Array.isArray(t)||(t=[t]);var n=new Date("".concat(e," 12:00:00+08:00")),r=t.filter((function(t){return new Date(t.timeStamp)<n})),i=t.filter((function(t){return new Date(t.timeStamp)>=n}));return a.push({AM:r,PM:i}),a}}]),t}(),s=new o(t,e,a,n,this,i);s.drawMultiDayData("mktPrice")},data_minmax:function(t){function e(t){var e=t.reduce((function(t,e){return t+e}),0)/t.length,a=t.reduce((function(t,a){return t+Math.pow(a-e,2)}),0)/t.length;return[e,a]}function a(t,e){var a=t[0],n=t[1],r=Math.sqrt(n),i=a+e*r,o=a-e*r;return[o,i]}var n=e(t),r=Math.max.apply(Math,Object(p["a"])(t)),i=Math.min.apply(Math,Object(p["a"])(t)),o=n[0],s=n[1],c=Math.sqrt(s),l=(o-i)/c,d=(r-o)/c;console.log("Min sigma multiplier:",l),console.log("Max sigma multiplier:",d);var u=Math.min(l,d);a(n,u);return[i,r]},fetchData:function(){var t=this;return Object(G["a"])(Object(H["a"])().mark((function e(){var a,n,r,i,o,s,c,l;return Object(H["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=function(t,e,a){return new Promise(function(){var n=Object(G["a"])(Object(H["a"])().mark((function n(r,i){var o;return Object(H["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return o=new Y(t,e,a),n.prev=1,n.next=4,o.generateData(t,e,a);case 4:r(o.dataPackage),n.next=10;break;case 7:n.prev=7,n.t0=n["catch"](1),i(n.t0);case 10:case"end":return n.stop()}}),n,null,[[1,7]])})));return function(t,e){return n.apply(this,arguments)}}())},n=function(t){var e=t[0],a=t[1],n=e+5*a,r=e-5*a;return[r,n]},a=function(t){var e=t.reduce((function(t,e){return t+e}),0)/t.length,a=t.reduce((function(t,a){return t+Math.pow(a-e,2)}),0)/t.length;return[e,a]},e.prev=3,e.next=6,r(t.bond_cd,t.end_date,t.duration_days);case 6:return i=e.sent,o=i.transaction.map((function(t){return t.netPrice})),s=a(o),c=n(s),l=U.a.cloneDeep(i),t.drawMultiCharts(l,t.bond_cd,t.end_date,t.duration_days,t,c),e.abrupt("return",i);case 15:e.prev=15,e.t0=e["catch"](3),console.log("Error:",e.t0);case 18:case"end":return e.stop()}}),e,null,[[3,15]])})))()}}},K=X,tt=(a("913f5"),a("2877")),et=Object(tt["a"])(K,P,A,!1,null,"5598c502",null),at=et.exports,nt={name:"MacroCard",components:{BCard:l["a"],BButton:D["a"],BCardBody:u["a"],BIconPlusSquare:S["j"],BIconDashSquare:S["e"],BCardHeader:d["a"],MarcoGlyph:at},props:["bond_cd","bond_name","transaction_num","transaction_volume","duration_days","end_date"],data:function(){return{selected:!1}},mounted:function(){},methods:{onClick:function(){this.selected=!this.selected,this.$root.$emit("ChangeBondSelection",this.bond_cd)},handleChangeBondSelection:function(t){this.bond_cd===t&&(this.selected=!this.selected)}},created:function(){var t=this;this.$root.$on("ChangeBondSelectionClose",(function(e){e==t.bond_cd&&(t.selected=!t.selected)}))},beforeDestroy:function(){}},rt=nt,it=Object(tt["a"])(rt,V,L,!1,null,null,null),ot=it.exports,st=a("6ff4"),ct=(st.format,{name:"MacroView",components:{BCard:l["a"],BIcon:v["a"],BIconArrowUp:S["c"],BIconArrowDown:S["a"],BButton:D["a"],BCardHeader:d["a"],BCardBody:u["a"],BNavbar:x["a"],BDropdown:w["a"],BDropdownGroup:k["a"],BDropdownItem:B["a"],BIconGear:S["h"],BFormTags:T["a"],VueSlider:g.a,BInputGroup:C["a"],BInputGroupText:I["a"],BFormInput:M["a"],MarcoCard:ot,BButtonGroup:j["a"],BButtonToolbar:O["a"]},props:["all_bond_list","end_date","duration_days"],data:function(){return{bond_list:null,transaction_num_range:["0","2000"],transaction_volume_range:["1000","50000"],transaction_num_range_list:["0","3","5","10","100","1000","2000"],transaction_volume_range_list:["1000","3000","5000","8000","10000","20000","50000"],Threshold_local:1,sortByNum:"",sortByVol:"",isSortByNumSelected:!1,isSortByVolSelected:!1,filteredBonds:null,searchQuery:"",date:null,marcoDataLoaded:!1}},methods:{fetchData:function(){var t=this;b["get"]("http://localhost:5003/api/bondSummaryData").then((function(e){t.bond_list=e.data.bondSummaryData,t.isLoading=!1,t.$emit("data-loaded",t.bond_list),t.marcoDataLoaded=!0})).catch((function(t){console.error("Error fetching bond summary data:",t)}))},timeClick:function(t){var e=t.toISOString().slice(0,10),a="http://localhost:5003/api/getAllData/".concat(e);console.log("timeClick",a),this.fetchData()},updateNumSort:function(t){this.sortByNum=t,this.isSortByNumSelected=!0,console.log(this.sortByNum)},updateVolSort:function(t){this.sortByVol=t,this.isSortByVolSelected=!0,console.log(this.sortByVol)}},created:function(){this.bond_list=this.all_bond_list},mounted:function(){},watch:{sortByNum:function(t){t&&(this.isSortByNumSelected=!0,this.isSortByVolSelected=!1)},sortByVol:function(t){t&&(this.isSortByVolSelected=!0,this.isSortByNumSelected=!1)},marcoDataLoaded:function(t){t&&console.log("marcoDataLoaded 已更新为 true，开始渲染 MarcoCard 组件")}},computed:{filteredAndSortedProjects:function(){var t=this,e=this.transaction_num_range.map((function(t){return parseInt(t)})),a=this.transaction_volume_range.map((function(t){return parseInt(t)})),n=Math.min.apply(Math,Object(p["a"])(e)),r=Math.max.apply(Math,Object(p["a"])(e)),i=Math.min.apply(Math,Object(p["a"])(a)),o=Math.max.apply(Math,Object(p["a"])(a));if(this.filteredBonds=this.bond_list.filter((function(t){var e=t.Transaction_num>=n&&t.Transaction_num<r,a=t.Transaction_volume>=i&&t.Transaction_volume<o;return e&&a})),!this.sortByNum&&!this.sortByVol)return this.filteredBonds;var s=Object(p["a"])(this.filteredBonds);return s=s.filter((function(e){var a=e.Bond_cd.toString();return e.Bond_name.toLowerCase().includes(t.searchQuery.toLowerCase())||a.toLowerCase().includes(t.searchQuery.toLowerCase())})),this.isSortByNumSelected&&("num_descending"===this.sortByNum?s.sort((function(t,e){return t.Transaction_num-e.Transaction_num})):"num_ascending"===this.sortByNum&&s.sort((function(t,e){return e.Transaction_num-t.Transaction_num}))),this.isSortByVolSelected&&("vol_descending"===this.sortByVol?s.sort((function(t,e){return t.Transaction_volume-e.Transaction_volume})):"vol_ascending"===this.sortByVol&&s.sort((function(t,e){return e.Transaction_volume-t.Transaction_volume}))),s}}}),lt=ct,dt=(a("316b"),Object(tt["a"])(lt,h,m,!1,null,"075a42f4",null)),ut=dt.exports,ht=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("b-card",{staticStyle:{height:"50%"},attrs:{"no-body":""}},[a("b-card-body",{staticStyle:{overflow:"scroll",height:"800px",padding:"2px"}},t._l(t.selected_bond_list,(function(e){return a("MesoCard",{key:e.Bond_cd,attrs:{bond_cd:e.Bond_cd,bond_name:e.Bond_name,transaction_num:e.Transaction_num,transaction_volume:e.Transaction_volume,end_date:t.end_date,duration_days:t.duration_days}})})),1)],1)],1)},mt=[],pt=a("ade3"),ft=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("b-card",{staticStyle:{border:"0px"},attrs:{"no-body":""}},[a("b-card-header",{staticClass:"small-header",staticStyle:{"font-size":"12px",height:"25px"}},[t._v(" "+t._s(t.bond_name)+" "),t.x_selected?t._e():a("b-button",{staticStyle:{"font-size":"12px",float:"right",height:"15px",padding:"0px 5px",display:"flex","align-items":"center"},attrs:{variant:"outline-secondary"},on:{click:function(e){return t.close_win()}}},[a("b-icon-x")],1),t.camera_selected?t._e():a("b-button",{staticStyle:{"font-size":"12px",float:"right","margin-right":"10px",padding:"0px 5px",height:"15px",display:"flex","align-items":"center"},attrs:{variant:"outline-secondary"},on:{click:function(e){return t.updateLassoAction("refresh")}}},[a("b-icon-arrow-repeat")],1),t.camera_selected?t._e():a("b-button",{staticStyle:{"font-size":"12px",float:"right","margin-right":"10px",padding:"0px 5px",height:"15px",display:"flex","align-items":"center"},attrs:{variant:"outline-secondary"},on:{click:function(e){return t.updateLassoAction("add")}}},[a("b-icon-plus")],1),t.camera_selected?t._e():a("b-button",{staticStyle:{"font-size":"12px",float:"right","margin-right":"10px",padding:"0px 5px",height:"15px",display:"flex","align-items":"center"},attrs:{variant:"outline-secondary"},on:{click:function(e){return t.updateLassoAction("remove")}}},[a("i",{staticClass:"el-icon-minus"})]),a("vue-slider",{staticStyle:{"margin-left":"20px",height:"450px","margin-top":"0px"},attrs:{direction:"btt",adsorb:!0,data:t.scaler_index_list,included:!0},model:{value:t.scaler_index,callback:function(e){t.scaler_index=e},expression:"scaler_index"}})],1),a("b-card-body",{staticClass:"meso_card_body",staticStyle:{height:"450px",padding:"5px 0px 5px 0px"}},[a("MicroView",{ref:"microViewRef",attrs:{bond_cd:t.bond_cd,end_date:t.end_date,duration_days:t.duration_days,scaler_index:t.scaler_index,scaler_index_high:t.scaler_index_high,scaler_index_low:t.scaler_index_low}})],1)],1)],1)},gt=[],_t=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("svg",{staticStyle:{width:"100%",height:"100%"},attrs:{id:"svg_micro_"+t.bond_cd+"_"+t.end_date+"_"+t.duration_days}})},bt=[];a("a630"),a("a15b"),a("6062"),a("3ca3"),a("ddb0"),a("7db0");d3.timeline;var yt=a("4360"),vt=(a("910e"),a("6ff4")),St=(vt.format,{props:["bond_cd","end_date","duration_days","scaler_index","scaler_index_high","scaler_index_low"],data:function(){return{fetchDataTimeout:null,MarketPriceList:!1,ValuationList:!1,TransactionList:!1,combinedMarketPriceData:!1,dataPackages_init:!1,dataPackages:!1,tradeChart_height:730,tradeChart_width:180,tradeChart_margin:{top:10,right:50,bottom:30,left:30},keyColor:{tradeLine:"#084177",valuationBox:"#cd8d7b",volumeBar:"#687466",tradeGradLine:"#fbc490",volumeGradLine:"#d2c6b2"},theSelection:[],theSelection_bond_cd:[],initialData:{},colorMapping:!1}},watch:{scaler_index:function(t){var e=this;t&&(clearTimeout(this.fetchDataTimeout),this.fetchDataTimeout=setTimeout((function(){e.deleteSvg(e.bond_cd,e.end_date,e.duration_days),e.fetchData()}),500))}},created:function(){var t=this;b["get"]("http://localhost:5003/api/color_mapping").then((function(e){t.colorMapping=e.data})).catch((function(t){console.error("Error fetching color mapping:",t)}))},computed:Object(i["a"])(Object(i["a"])({},Object(o["d"])({})),Object(o["c"])("lassoInteraction",["getLatestSelectionBondcd","getLatestSelection","getGlobalLassoData","getGlobalHistory","getChangedTransaction","getGlobalLassoDataHistory","getHistoryActions","getHistoryIndex"])),beforeMount:function(){},mounted:function(){this.dataPackages=this.fetchData()},beforeDestroy:function(){},methods:Object(i["a"])(Object(i["a"])({},Object(o["b"])(["updateLassoSelectedTrans"])),{},{send_data:function(){},deleteSvg:function(t,e,a){var n=d3.select("#svg_micro_"+t+"_"+e+"_"+a);n.selectAll("*").remove()},drawMultiCharts:function(t,e,a,n,r,i){var o=this;return Object(G["a"])(Object(H["a"])().mark((function s(){var c,l;return Object(H["a"])().wrap((function(s){while(1)switch(s.prev=s.next){case 0:return c=function(){function t(e,a,n,o,s){Object(z["a"])(this,t),this.allData=U.a.cloneDeep(e),this.bond_cd=a,this.endDay=n,this.duration_days=o,this.margin={top:3,right:3,bottom:3,left:3},this.width=1200,this.theWidth=!1,this.halfDayHours=!1,this.height=500,this.vueComponent=s,this.upper=r[0],this.lower=r[1],this.marginTop=5,this.marginRight=20,this.marginBottom=35,this.marginLeft=39,this.colorMapping=i;var c=d3.select("#svg_micro_"+a+"_"+n+"_"+o).append("svg").attr("name","Container").attr("width",this.width).attr("height",this.height);this.chartContainer=c;var l=this.chartContainer.append("svg").attr("width",this.width).attr("height",this.height).attr("name","lassoContainer");this.lassoContainer=l;var d=this.chartContainer.append("svg").attr("width",this.width).attr("height",this.height).attr("name","lineContainer");this.lineContainer=d;var u=this.chartContainer.append("svg").attr("width",this.width).attr("height",this.height).attr("name","InstitutionContainer");this.InstitutionContainer=u;var h=this.chartContainer.append("svg").attr("width",this.width).attr("height",this.height).attr("name","VolumeBarContainer");this.VolumeBarContainer=h}return Object(E["a"])(t,[{key:"getDate",value:function(t){var e=new Date(t),a=e.getFullYear().toString(),n=(e.getMonth()+1).toString().padStart(2,"0"),r=e.getDate().toString().padStart(2,"0"),i="".concat(a,"-").concat(n,"-").concat(r);return i}},{key:"drawMultiDayData",value:function(){var t=Object(G["a"])(Object(H["a"])().mark((function t(e){var a,n,r,i,o=this;return Object(H["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,U.a.cloneDeep(this.allData[e]);case 2:a=t.sent,this.allData[e].sort((function(t,e){return new Date(t.timeStamp)-new Date(e.timeStamp)})),n={},a.forEach((function(t){var e=o.getDate(t.timeStamp);n[e]||(n[e]=[]),n[e].push(t)})),r=U.a.cloneDeep(n),i=2*Object.keys(r).length,Object.entries(r).forEach((function(t,a){var n=Object(R["a"])(t,2),r=n[0],s=n[1],c=100;o.width=o.width-c;var l=2*o.width/i*3/7,d=(o.width,2*a/i*o.width+c),u=d+l,h=o.dataFilter(s,r),m=U.a.cloneDeep(h),p=m[0].AM,f=m[0].PM,g=U.a.cloneDeep(p),_=U.a.cloneDeep(f);o.drawDayData(g,e,r,d,"AM",i),o.drawDayData(_,e,r,u,"PM",i)}));case 9:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"drawDayData",value:function(t,e,a,n,r,i){var o=!1,s=!1;switch("AM"===r&&(o=this.offsetTime(a,9,0),s=this.offsetTime(a,12,0)),"PM"===r&&(o=this.offsetTime(a,13,30),s=this.offsetTime(a,17,30)),e){case"mktPrice":this.drawMktPriceLine(t,n,r,o,s,i);break;case"valuation":this.drawValuationLine(t,n,o,s,i);break;case"volume":this.drawVolumeBar(t,n,r,o,s,i);break;case"transaction":this.drawTrasactionScatter(t,n,r,o,s,i);break;case"gradient":this.drawGradTimeline(t,n,o,s,i);break}}},{key:"formatDateToCustomString",value:function(t){var e=new Date(t),a=e.getFullYear(),n=(e.getMonth()+1).toString().padStart(2,"0"),r=e.getDate().toString().padStart(2,"0"),i=e.getHours().toString().padStart(2,"0"),o=e.getMinutes().toString().padStart(2,"0"),s=e.getSeconds().toString().padStart(2,"0"),c="".concat(a,"_").concat(n,"_").concat(r,"_").concat(i,"_").concat(o,"_").concat(s);return c}},{key:"formatDateToCustomDateString",value:function(t){var e=new Date(t),a=e.getFullYear(),n=(e.getMonth()+1).toString().padStart(2,"0"),r=e.getDate().toString().padStart(2,"0"),i=e.getHours().toString().padStart(2,"0"),o=e.getMinutes().toString().padStart(2,"0"),s=e.getSeconds().toString().padStart(2,"0"),c="".concat(a,"-").concat(n,"-").concat(r," ").concat(i,":").concat(o,":").concat(s);return c}},{key:"offsetTime",value:function(t,e,a){var n=new Date(t),r=1e3*(3600*e+60*a),i=n.getTime()+r,o=new Date(i),s=o.getFullYear(),c=(o.getMonth()+1).toString().padStart(2,"0"),l=o.getDate().toString().padStart(2,"0"),d=o.getHours().toString().padStart(2,"0"),u=o.getMinutes().toString().padStart(2,"0"),h=o.getSeconds().toString().padStart(2,"0"),m="".concat(s,"-").concat(c,"-").concat(l,"T").concat(d,":").concat(u,":").concat(h,".000Z");return m}},{key:"drawMktPriceLine",value:function(t,e,a,n,r,i){t.forEach((function(t){var e=t.timeStamp.slice(0,-6);t.timeStamp=e,t.timeStamp=new Date(t.timeStamp)})),t.sort((function(t,e){return t.timeStamp-e.timeStamp})),n=this.formatDateToCustomDateString(n),r=this.formatDateToCustomDateString(r);var o=2*this.width/i*3/7,s=2*this.width/i*4/7;"AM"===a&&(this.theWidth=o),"PM"===a&&(this.theWidth=s);var c=.8*this.height,l=0,d=d3.scaleTime().range([0,this.theWidth]).domain([d3.min(t,(function(t){return t.timeStamp})),d3.max(t,(function(t){return t.timeStamp}))]),u=d3.scaleLinear().range([l,c]).domain([this.lower,this.upper]),h=d3.line().x((function(t){return d(t.timeStamp)})).y((function(t){return u(t.netValue)})).curve(d3.curveCatmullRom.alpha(.5)),m=d3.area().x((function(t){return d(t.timeStamp)})).y0((function(t){return u(t.netValue-.02)})).y1((function(t){return u(t.netValue+.02)}));this.lineContainer.append("g").append("path").datum(t).attr("class","line").attr("d",h).attr("transform","translate(".concat(e,", 0)")).style("stroke",d3.schemeRdYlBu[3][2]).style("stroke-width",2).style("fill","none"),this.lineContainer.append("g").append("path").datum(t).attr("fill","steelblue").attr("opacity",.2).attr("transform","translate(".concat(e,", 0)")).attr("d",m)}},{key:"drawValuationLine",value:function(t,e,a,n){var r=this;d3.scaleLinear().domain([0,d3.max(t,(function(t){return t.transactionVolume}))]).range([0,10]);this.chartContainer.selectAll("rect").data(t).enter().append("rect").attr("cx",(function(t,e){return 10*e})).attr("cy",(function(t,e){return r.height-1*t.netPrice}))}},{key:"drawTrasactionScatter",value:function(t,e,a,n,r,i){var o=this;t.forEach((function(t){var e=t.timeStamp.slice(0,-6);t.timeStamp=e,t.timeStamp=new Date(t.timeStamp)})),console.log("data 562:",t),n=this.formatDateToCustomDateString(n),r=this.formatDateToCustomDateString(r);var s=2*this.width/i*3/7,c=2*this.width/i*4/7;"AM"===a&&(this.theWidth=s),"PM"===a&&(this.theWidth=c);var l=d3.scaleTime().range([0,this.theWidth]).domain([d3.min(t,(function(t){return t.timeStamp})),d3.max(t,(function(t){return t.timeStamp}))]),d=.8*this.height,u=0,h=d3.scaleLinear().domain([this.lower,this.upper]).range([u,d]),m=d3.scaleLinear().domain([-100,100]).range([d,u]),p=(d3.max(t,(function(t){return Math.abs(t.transactionVolume)})),d3.min(t,(function(t){return Math.abs(t.transactionVolume)})),d3.rgb(174,219,155),d3.rgb(162,162,162),d3.rgb(219,76,85),d3.rgb(255,210,186)),f=(d3.scaleLinear().range([1,5]).domain([1e3,3e3]),function(t){return t.attr("stroke","currentColor").attr("stroke-opacity",.05).call((function(t){return t.append("g").selectAll("line").data(l.ticks()).join("line").attr("x1",(function(t){return.5+l(t)})).attr("x2",(function(t){return.5+l(t)})).attr("y1",.8*o.height).attr("y2",0)})).attr("transform","translate(".concat(e,", 0)")).call((function(t){return t.append("g").selectAll("line").data(h.ticks()).join("line").attr("y1",(function(t){return.5+h(t)})).attr("y2",(function(t){return.5+h(t)})).attr("x1",0).attr("x2",o.theWidth)}))});this.lassoContainer.append("g").attr("stroke","#000").attr("stroke-opacity",.2).selectAll("circle").data(t).enter().append("circle").attr("cx",(function(t){return l(t.timeStamp)})).attr("cy",(function(t){return h(t.netPrice)})).attr("r",(function(t){return Math.sqrt(50*t.transactionVolume)/3.14})).attr("fill",(function(t){var e=o.colorMapping[t.byr_instn_tp];return e?d3.rgb(e[0],e[1],e[2]):p})).attr("transform","translate(".concat(e,", 0)")).style("opacity",.4),this.lassoContainer.append("g").call(f),this.lassoContainer.append("g").attr("transform","translate(".concat(e,", ").concat(.8*this.height-40,")")).call(d3.axisBottom(l).ticks(this.width/100)).call((function(t){return t.select(".domain").remove()})).call((function(t){return t.append("text").attr("x",o.width-5).attr("y",o.marginBottom).attr("fill","currentColor").attr("text-anchor","end").text("Time →")})),this.lassoContainer.append("g").attr("transform","translate(".concat(this.marginLeft+60,", 0)")).call(d3.axisLeft(h)).call((function(t){return t.select(".domain").remove()})).call((function(t){return t.append("text").attr("x",-30).attr("y",10).attr("fill","currentColor").attr("text-anchor","start")})),this.lassoContainer.append("g").attr("transform","translate(".concat(this.marginLeft,", 10)")).call(d3.axisLeft(m)).call((function(t){return t.select(".domain").remove()})).call((function(t){return t.append("text").attr("x",-34).attr("y",-5).attr("fill","currentColor").attr("text-anchor","start").text(" σ ")}))}},{key:"drawInstitution",value:function(t,e,a,n,r,i){var o=this;t.forEach((function(t){var e=t.timeStamp.slice(0,-6);t.timeStamp=e,t.timeStamp=new Date(t.timeStamp)})),n=this.formatDateToCustomDateString(n),r=this.formatDateToCustomDateString(r);var s=2*this.width/i*3/7,c=2*this.width/i*4/7;"AM"===a&&(this.theWidth=s),"PM"===a&&(this.theWidth=c);var l=d3.scaleTime().range([0,this.theWidth]).domain([d3.min(t,(function(t){return t.timeStamp})),d3.max(t,(function(t){return t.timeStamp}))]),d=.8*this.height,u=0,h=d3.scaleLinear().domain([this.lower,this.upper]).range([d,u]),m=(d3.max(t,(function(t){return Math.abs(t.transactionVolume)})),d3.min(t,(function(t){return Math.abs(t.transactionVolume)})),d3.rgb(174,219,155),d3.rgb(162,162,162),d3.rgb(219,76,85),d3.rgb(255,210,186)),p=d3.scaleLinear().range([1,5]).domain([1e3,3e3]);this.lassoContainer.append("g").attr("stroke","#000").attr("stroke-opacity",.2).selectAll("circle").data(t).enter().append("circle").attr("cx",(function(t){return l(t.timeStamp)})).attr("cy",(function(t){return h(t.netPrice)})).attr("r",(function(t){return p(Math.sqrt(t.transactionVolume)/3.14)})).attr("fill",(function(t){var e=o.colorMapping[t.byr_instn_tp];return e?d3.rgb(e[0],e[1],e[2]):m})).attr("transform","translate(".concat(e,", 0)")).style("opacity",.4),this.lassoContainer.append("g").attr("transform","translate(".concat(e,", ").concat(.8*this.height-10,")")).call(d3.axisBottom(l).ticks(this.width/100)).call((function(t){return t.select(".domain").remove()})).call((function(t){return t.append("text").attr("x",o.width-5).attr("y",o.marginBottom-10).attr("fill","currentColor").attr("text-anchor","end").text("Time →")})),this.lassoContainer.append("g").attr("transform","translate(".concat(this.marginLeft+60,", 0)")).call(d3.axisLeft(h)).call((function(t){return t.select(".domain").remove()})).call((function(t){return t.append("text").attr("x",20).attr("y",10).attr("fill","currentColor").attr("text-anchor","start")}))}},{key:"drawVolumeBar",value:function(t,e,a,n,r,i){var o=this;function s(t,e){var a=new Date(t),n=a.getFullYear(),r=(a.getMonth()+1).toString().padStart(2,"0"),i=a.getDate().toString().padStart(2,"0"),o=Math.floor(a.getHours()).toString().padStart(2,"0"),s=Math.floor(a.getMinutes()/e)*e,c=s.toString().padStart(2,"0"),l="".concat(n,"-").concat(r,"-").concat(i," ").concat(o,":").concat(c);return new Date(l)}var c=5;t.forEach((function(t){t.timeStamp=new Date(t.timeStamp)}));var l=this.bucketDataByMinute(t,c);n=this.formatDateToCustomDateString(n),r=this.formatDateToCustomDateString(r),this.width=1e3;var d=2*this.width/i*3/7,u=2*this.width/i*4/7;"AM"===a&&(this.theWidth=d,this.halfDayHours=3),"PM"===a&&(this.theWidth=u,this.halfDayHours=4,e=530);var h=l.map((function(t){return d3.sum(t,(function(t){return t.transactionVolume}))})),m=d3.max(h),p=d3.scaleTime().range([0,this.theWidth]).domain([d3.min(t,(function(t){return t.timeStamp})),d3.max(t,(function(t){return t.timeStamp}))]),f=d3.scaleLinear().range([0,.1*this.height]).domain([0,m]);this.VolumeBarContainer.append("g").selectAll("rect").data(l).attr("class","volumeBar").enter().append("rect").attr("x",(function(t){return p(s(t[0].timeStamp,c))})).attr("y",(function(t){return.88*o.height-f(d3.sum(t,(function(t){return t.transactionVolume})))})).attr("height",(function(t){return f(d3.sum(t,(function(t){return t.transactionVolume})))})).attr("width",this.theWidth*c/(60*this.halfDayHours)).attr("fill","SteelBlue").attr("transform","translate(".concat(e,", 0)")).on("mouseover",(function(){d3.select(this).attr("fill","Maroon")})).on("mouseout",(function(){d3.select(this).attr("fill","SteelBlue")}))}},{key:"bucketDataByMinute",value:function(t,e){var a={};t.forEach((function(t){var n=new Date(t.timeStamp),r=(Math.floor(n.getHours()).toString()+"-"+Math.floor(n.getMinutes()/e)*e.toString()).toString();a[r]||(a[r]=[]),a[r].push(t)}));var n=Object.values(a);return n}},{key:"drawGradTimeline",value:function(t,e,a,n,r){var i=10;this.bucketDataByMinute(t,i),d3.timeParse("%Y/%m/%d %H:%M:%S");a=this.formatDateToCustomDateString(a),n=this.formatDateToCustomDateString(n);var o=d3.scaleTime().range([0,this.width]).domain([d3.min(t,(function(t){return t.timeStamp})),d3.max(t,(function(t){return t.timeStamp}))]),s=[{startDate:"2017-06-29T01:33:03.988Z",endDate:"2017-09-10T07:51:43.818Z",name:"event383"},{startDate:"2017-06-11T06:32:17.887Z",endDate:"2017-10-23T10:23:17.065Z",name:"event384"},{startDate:"2017-11-08T23:28:11.281Z",endDate:"2017-11-13T07:54:34.614Z",name:"event385"},{startDate:"2016-11-19T03:41:04.917Z",endDate:"2017-08-28T06:29:05.559Z",name:"event386"},{startDate:"2017-06-02T14:01:20.799Z",endDate:"2017-06-03T20:49:25.676Z",name:"event387"},{startDate:"2017-09-22T21:50:17.825Z",endDate:"2017-10-12T13:56:05.972Z",name:"event388"},{startDate:"2017-07-15T10:38:35.760Z",endDate:"2017-09-27T12:09:17.202Z",name:"event389"},{startDate:"2017-06-29T10:14:34.872Z",endDate:"2017-07-22T11:45:15.488Z",name:"event390"},{startDate:"2017-06-18T17:56:56.597Z",endDate:"2017-08-09T03:35:53.160Z",name:"event391"},{startDate:"2017-07-12T12:41:18.234Z",endDate:"2017-10-16T08:34:34.768Z",name:"event392"},{startDate:"2017-08-07T01:53:14.537Z",endDate:"2017-08-27T00:59:19.305Z",name:"event393"},{startDate:"2017-08-19T00:17:16.190Z",endDate:"2017-11-03T20:29:22.870Z",name:"event394"},{startDate:"2017-09-11T05:23:24.449Z",endDate:"2017-09-29T22:25:24.258Z",name:"event395"},{startDate:"2017-06-26T22:40:55.276Z",endDate:"2017-10-07T06:26:10.546Z",name:"event396"},{startDate:"2017-09-26T07:12:38.705Z",endDate:"2017-11-05T00:36:12.767Z",name:"event397"},{startDate:"2017-10-06T22:06:34.863Z",endDate:"2017-10-11T04:13:12.963Z",name:"event398"},{startDate:"2017-07-08T18:57:28.499Z",endDate:"2017-08-20T00:38:01.351Z",name:"event399"},{startDate:"2017-06-16T10:49:16.527Z",endDate:"2017-10-11T08:27:56.869Z",name:"event400"},{startDate:"2017-07-02T18:21:26.025Z",endDate:"2017-07-17T20:33:07.886Z",name:"event401"},{startDate:"2017-07-04T05:26:28.683Z",endDate:"2017-11-16T18:44:33.776Z",name:"event402"},{startDate:"2017-03-17T03:02:08.775Z",endDate:"2017-08-16T07:05:05.381Z",name:"event403"},{startDate:"2017-10-04T09:04:49.185Z",endDate:"2017-10-29T22:28:56.582Z",name:"event404"},{startDate:"2017-07-14T06:51:20.243Z",endDate:"2017-08-30T12:21:37.686Z",name:"event405"},{startDate:"2017-09-15T22:12:10.257Z",endDate:"2017-10-16T19:00:16.029Z",name:"event406"},{startDate:"2017-06-28T08:09:09.314Z",endDate:"2017-07-28T05:49:05.731Z",name:"event407"},{startDate:"2017-03-01T21:38:48.509Z",endDate:"2017-10-23T08:02:34.320Z",name:"event408"},{startDate:"2017-10-13T20:17:38.413Z",endDate:"2017-10-14T05:02:58.801Z",name:"event409"},{startDate:"2017-07-14T11:16:59.256Z",endDate:"2017-10-25T07:05:32.893Z",name:"event410"},{startDate:"2017-05-02T09:07:43.910Z",endDate:"2017-11-16T06:18:27.737Z",name:"event411"},{startDate:"2017-09-11T21:52:27.963Z",endDate:"2017-10-21T14:54:53.872Z",name:"event412"},{startDate:"2017-11-05T11:30:41.783Z",endDate:"2017-11-15T11:50:20.677Z",name:"event413"},{startDate:"2017-07-30T23:49:30.404Z",endDate:"2017-09-01T15:11:17.455Z",name:"event414"},{startDate:"2017-06-14T21:45:16.150Z",endDate:"2017-11-07T02:13:58.099Z",name:"event415"},{startDate:"2017-07-04T01:29:43.846Z",endDate:"2017-10-23T12:46:39.915Z",name:"event416"},{startDate:"2017-05-07T20:44:07.137Z",endDate:"2017-08-11T20:44:41.717Z",name:"event417"},{startDate:"2017-08-01T14:51:08.454Z",endDate:"2017-08-21T08:38:45.877Z",name:"event418"},{startDate:"2017-08-04T10:29:07.502Z",endDate:"2017-08-04T14:34:50.825Z",name:"event419"},{startDate:"2017-08-02T20:04:38.723Z",endDate:"2017-10-30T02:22:24.100Z",name:"event420"},{startDate:"2017-09-24T16:36:57.959Z",endDate:"2017-11-07T01:02:21.734Z",name:"event421"},{startDate:"2017-06-09T21:46:34.002Z",endDate:"2017-08-17T05:27:38.053Z",name:"event422"},{startDate:"2017-06-22T15:14:09.640Z",endDate:"2017-07-21T23:15:46.245Z",name:"event423"},{startDate:"2017-02-22T10:27:17.751Z",endDate:"2017-07-30T17:47:23.495Z",name:"event424"},{startDate:"2017-09-07T15:37:57.441Z",endDate:"2017-10-14T00:49:11.922Z",name:"event425"},{startDate:"2017-02-18T01:59:00.491Z",endDate:"2017-04-26T20:18:15.741Z",name:"event426"},{startDate:"2016-12-25T02:13:38.968Z",endDate:"2017-10-08T12:19:27.944Z",name:"event427"},{startDate:"2017-07-07T07:18:37.989Z",endDate:"2017-07-17T05:02:55.671Z",name:"event428"},{startDate:"2017-10-14T12:34:00.024Z",endDate:"2017-11-07T06:41:27.842Z",name:"event429"},{startDate:"2017-10-20T20:25:54.278Z",endDate:"2017-11-05T02:37:13.328Z",name:"event430"},{startDate:"2017-10-27T03:21:00.372Z",endDate:"2017-10-27T16:17:05.648Z",name:"event431"},{startDate:"2017-02-15T10:16:13.211Z",endDate:"2017-05-17T07:40:27.438Z",name:"event432"},{startDate:"2017-01-04T18:38:09.534Z",endDate:"2017-05-08T15:46:44.590Z",name:"event433"},{startDate:"2017-09-24T10:48:47.506Z",endDate:"2017-10-24T11:13:20.501Z",name:"event434"},{startDate:"2017-05-31T15:18:23.331Z",endDate:"2017-09-25T09:26:00.723Z",name:"event435"},{startDate:"2017-05-30T20:19:23.390Z",endDate:"2017-11-09T05:59:55.646Z",name:"event436"}],c=d3.timeParse("%Y-%m-%dT%H:%M:%S.%LZ");s.forEach((function(t){t.startDate=c(t.startDate),t.endDate=c(t.endDate)})),this.chartContainer.append("g").selectAll("rect").data(s).enter().append("rect").attr("x",(function(t){return o(t.startDate)})).attr("y",this.height-10).attr("width",(function(t){return o(t.endDate)-o(t.startDate)})).attr("height",10).attr("fill","#FFD325").attr("rx",4).attr("stroke","white").style("stroke-width",2).attr("fill","none")}},{key:"dataFilter",value:function(t,e){var a=[];Array.isArray(t)||(t=[t]);var n=new Date("".concat(e," 12:00:00+08:00")),r=t.filter((function(t){return new Date(t.timeStamp)<n})),i=t.filter((function(t){return new Date(t.timeStamp)>=n}));return a.push({AM:r,PM:i}),a}},{key:"lassoFunction",value:function(){var t=this.lassoContainer,a=this.vueComponent;d3.rgb(174,219,155),d3.rgb(162,162,162),d3.rgb(219,76,85),d3.rgb(255,210,186);function n(t){var e=yt["a"].getters["lassoInteraction/getChangedTransaction"];if(e!=[]){d3.rgb(174,219,155),d3.rgb(162,162,162);for(var a=d3.rgb(219,76,85),n=(d3.rgb(255,210,186),t.selectAll("circle")),r=n._groups[0],i=function(){var t=r[o],n=t.__data__.transactionId,i=e.some((function(t){return t.transactionId===n}));i&&d3.select(t).style("stroke",a).style("stroke-width",6)},o=1;o<r.length-1;o++)i()}}function r(t){var e=yt["a"].getters["lassoInteraction/getGlobalLassoData"];if(void 0!=e){d3.rgb(174,219,155),d3.rgb(162,162,162);for(var a=d3.rgb(219,76,85),n=d3.rgb(255,210,186),r=t.selectAll("circle"),i=r._groups[0],o=function(){var t=i[s],r=t.__data__.transactionId,o=e.some((function(t){return t.transactionId===r}));o?d3.select(t).style("stroke",a).style("stroke-width",2):d3.select(t).style("stroke",n).style("stroke-width",1)},s=1;s<i.length-1;s++)o()}}var i=function(){console.log("start"),l.items().classed("not_possible",!0).classed("selected",!1)},o=function(){console.log("draw"),l.possibleItems().classed("not_possible",!1).classed("possible",!0),l.notPossibleItems().classed("not_possible",!0).classed("possible",!1)},s=function(){console.log("end"),l.items().classed("not_possible",!1).classed("possible",!1),l.selectedItems().classed("selected",!0),l.notSelectedItems();var i=l.selectedItems(),o=[];i.each((function(t){var e=d3.select(this).data()[0];o.push(e),console.log("vueComponent.TransactionList",a.dataPackages)})),a.theSelection=o;var s={bondcd:e,theSelection:a.theSelection,allData:a.TransactionList};yt["a"].dispatch("lassoInteraction/updateTempSelection",s),n(t),r(t)},c=t.selectAll("g circle"),l=d3.lasso().closePathDistance(305).closePathSelect(!0).targetArea(t).items(c).on("start",i).on("draw",o).on("end",s);return t.call(l),t.append("rect").attr("width","100%").attr("height","100%").attr("fill","transparent").attr("pointer-events","all"),this.lassoContainer.node()}}]),t}(),l=new c(t,e,a,n,o),s.next=4,l.drawMultiDayData("mktPrice");case 4:return s.next=6,l.drawMultiDayData("transaction");case 6:return s.next=8,l.drawMultiDayData("volume");case 8:l.lassoFunction();case 9:case"end":return s.stop()}}),s)})))()},fetchData:function(){var t=this;return Object(G["a"])(Object(H["a"])().mark((function e(){var a,n,r,i,o,s,c,l,d;return Object(H["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=function(t,e,a){return new Promise(function(){var n=Object(G["a"])(Object(H["a"])().mark((function n(r,i){var o;return Object(H["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return o=new Y(t,e,a),n.prev=1,n.next=4,o.generateData(t,e,a);case 4:r(o.dataPackage),n.next=10;break;case 7:n.prev=7,n.t0=n["catch"](1),i(n.t0);case 10:case"end":return n.stop()}}),n,null,[[1,7]])})));return function(t,e){return n.apply(this,arguments)}}())},n=function(t,e){var a=t[0],n=t[1],r=a+e[1]*n,i=a+e[0]*n;return[i,r]},a=function(t){var e=t.reduce((function(t,e){return t+e}),0)/t.length,a=t.reduce((function(t,a){return t+Math.pow(a-e,2)}),0)/t.length;return[e,a]},e.prev=3,e.next=6,r(t.bond_cd,t.end_date,t.duration_days);case 6:return i=e.sent,o=i.transaction.map((function(t){return t.netPrice})),s=a(o),c=n(s,t.scaler_index),l=U.a.cloneDeep(i),d={bondcd:t.bond_cd,allTransactions:l.transaction},yt["a"].dispatch("lassoInteraction/updateAllData",d),t.drawMultiCharts(l,t.bond_cd,t.end_date,t.duration_days,c,t.colorMapping),e.abrupt("return",i);case 17:e.prev=17,e.t0=e["catch"](3),console.log("Error:",e.t0);case 20:case"end":return e.stop()}}),e,null,[[3,17]])})))()},performAddAction:function(t){var e=this,a=this.getLassoSelectedTrans,n=this.theSelection;switch(n&&n.length>0?this.theSelection_bond_cd=n[0]["bond_cd"]:this.theSelection_bond_cd="default_value",t){case"add":a.hasOwnProperty(this.theSelection_bond_cd)||(a[this.theSelection_bond_cd]=[]),n.forEach((function(t){a[e.theSelection_bond_cd].push(t)})),console.log("selectedData 948",n);var r=new Set(a[this.theSelection_bond_cd]);a[this.theSelection_bond_cd]=Array.from(r);break;case"delete":if(a.hasOwnProperty(this.theSelection_bond_cd)){var i=[];a[this.theSelection_bond_cd].forEach((function(t){n.includes(t)||i.push(t)})),a[this.theSelection_bond_cd]=i}break}return console.log("lassoSelectedTrans 967",a),a},triggerInfoView:function(){}})}),Dt=St,xt=(a("ba8f"),Object(tt["a"])(Dt,_t,bt,!1,null,null,null)),wt=xt.exports,kt={name:"MesoCard",components:{BCard:l["a"],BButton:D["a"],BCardHeader:d["a"],BIconArrowRepeat:S["b"],BIconPlus:S["i"],BCardBody:u["a"],BIconX:S["k"],MicroView:wt,VueSlider:g.a},props:["bond","bond_cd","bond_name","end_date","duration_days"],data:function(){return{x_selected:!1,camera_selected:!1,scaler_mean:"100",scaler_index:["20","-20"],scaler_index_list:this.generateScalerIndexList(-100,100),scaler_index_low:["30"],scaler_index_low_list:["0.5","1","3","5","10","20","30","50","100","200","300","400"],scaler_index_high:["30"],scaler_index_high_list:["0.5","1","3","5","10","20","30","50","100","200","300","400"]}},computed:Object(i["a"])({},Object(o["c"])("lassoInteraction",["getLatestSelectionBondcd","getLatestSelection","getGlobalLassoData","getGlobalHistory","getChangedTransaction","getGlobalLassoDataHistory","getHistoryActions","getHistoryIndex"])),watch:{},mounted:function(){},methods:{generateScalerIndexList:function(t,e){for(var a=[],n=t;n<=e;n+=5)a.push(n.toString());return a},close_win:function(){this.$root.$emit("ChangeBondSelectionClose",this.bond_cd)},updateLassoAction:function(t){var e=this;console.log("action",t);var a={bondcd:this.getLatestSelectionBondcd,action:t,transactions:this.getLatestSelection};console.log("payload147",a),yt["a"].dispatch("lassoInteraction/updateSelection",a).then((function(){console.log(t," 完成"),e.highlightCircles()})).catch((function(e){console.error(t,"出错",e)}))},highlightCircles:function(){var t=this.$refs.microViewRef,e=d3.select(t.$el).select("svg"),a=yt["a"].getters["lassoInteraction/getGlobalLassoData"];if(void 0!=a){d3.rgb(174,219,155),d3.rgb(162,162,162);for(var n=d3.rgb(219,76,85),r=d3.rgb(255,210,186),i=e.selectAll("circle"),o=i._groups[0],s=function(){var t=o[c],e=t.__data__.transactionId,i=a.some((function(t){return t.transactionId===e}));i?d3.select(t).style("stroke",n).style("stroke-width",6):d3.select(t).style("stroke",r).style("stroke-width",1)},c=1;c<o.length-1;c++)s()}}}},Bt=kt,Tt=(a("73ad"),Object(tt["a"])(Bt,ft,gt,!1,null,"9f6bdff0",null)),Ct=Tt.exports,It=Object(pt["a"])({name:"MesoView",components:{BCard:l["a"],BIcon:v["a"],BIconArrowUp:S["c"],BIconArrowDown:S["a"],BButton:D["a"],BCardHeader:d["a"],BCardBody:u["a"],BNavbar:x["a"],BDropdown:w["a"],BDropdownGroup:k["a"],BDropdownItem:B["a"],BIconGear:S["h"],BFormTags:T["a"],VueSlider:g.a,BInputGroup:C["a"],BInputGroupText:I["a"],BFormInput:M["a"],BButtonGroup:j["a"],BButtonToolbar:O["a"],MesoCard:Ct},props:["selected_bond_list","end_date","duration_days"],data:function(){return{}},computed:{},methods:{},created:function(){},mounted:function(){},watch:{}},"computed",{}),Mt=It,jt=(a("f829"),Object(tt["a"])(Mt,ht,mt,!1,null,"741bb62c",null)),Ot=jt.exports,Vt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("b-card",{staticStyle:{height:"70%"},attrs:{"no-body":""}},[a("div",[a("b-tabs",{attrs:{"content-class":"mt-2",fill:""}},[a("b-tab",{attrs:{active:""},scopedSlots:t._u([{key:"title",fn:function(){return[a("span",{staticStyle:{"font-size":"15px"}},[t._v("Statistic")])]},proxy:!0}])},[a("b-card",{staticStyle:{height:"70%"},attrs:{"no-body":""}},[t.CurrentBondData?a("b-card-body",{staticStyle:{overflow:"scroll",height:"712px",padding:"2px"}},t._l(t.sortCurrentInstnType,(function(e){return a("Type-card",{directives:[{name:"show",rawName:"v-show",value:"buyer"===t.selectedbuyerseller,expression:"selectedbuyerseller === 'buyer'"}],key:e.transactionId,ref:"infoCardComponent",refInFor:!0,attrs:{transaction_name:e.transactionId,bond_data:e,end_date:t.end_date,duration_days:t.duration_days}})})),1):t._e()],1)],1),a("b-tab",{scopedSlots:t._u([{key:"title",fn:function(){return[a("span",{staticStyle:{"font-size":"15px"}},[t._v("Institution")])]},proxy:!0}])},[a("b-card",{staticStyle:{height:"70%"},attrs:{"no-body":""}},[t.CurrentBondData?a("b-card-body",{staticStyle:{overflow:"scroll",height:"712px",padding:"2px"}},t._l(t.sortCurrentInstn,(function(e){return a("Institution-card",{directives:[{name:"show",rawName:"v-show",value:"price"===t.selectedPriceVolume,expression:"selectedPriceVolume === 'price'"}],key:e.transactionId,ref:"infoCardComponent",refInFor:!0,attrs:{transaction_name:e.transactionId,bond_data:e,end_date:t.end_date,duration_days:t.duration_days}})})),1):t._e()],1)],1),a("b-tab",{scopedSlots:t._u([{key:"title",fn:function(){return[a("span",{staticStyle:{"font-size":"15px"}},[t._v("Trans")])]},proxy:!0}])},[a("b-card",{staticStyle:{height:"70%"},attrs:{"no-body":""}},[t.CurrentBondData?a("b-card-body",{staticStyle:{overflow:"scroll",height:"484px",padding:"2px"}},t._l(t.sortCurrentTransaction,(function(e){return a("info-card",{key:e.instn_cd,ref:"infoCardComponent",refInFor:!0,attrs:{transaction_name:e.transactionId,bond_data:e},on:{the_transaction_data:t.handleDataFromChild}})})),1):t._e()],1),a("b-card",{staticStyle:{height:"300px"},attrs:{"no-body":""}},[t.infomationList?a("b-table",{staticClass:"custom-table",attrs:{responsive:"",items:t.infomationList}}):t._e()],1)],1)],1)],1)])],1)},Lt=[],Zt=a("29a1"),Pt=a("f902"),At=a("6190"),Ht=a("01e3"),Gt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("b-card",{class:{highlighted:t.isCardHighlighted},attrs:{"no-body":""},on:{mousedown:t.highlightCard,mouseup:t.unhighlightCard,click:function(e){return t.sendDataToParent()}}},[a("b-card-header",{staticClass:"small-header",staticStyle:{"font-size":"12px",padding:"2px 2px",height:"21px"}},[a("div",{staticStyle:{transform:"scale(0.8)",display:"flex","margin-left":"-15px"}},[t._v(" "+t._s(t.transaction_name)+" ")])]),a("b-card-body",{staticStyle:{"font-size":"12px !important",padding:"2px",height:"44px",display:"flex","align-items":"left","justify-content":"left"},attrs:{id:"mg_"+t.bond_cd}},[a("div",{staticStyle:{transform:"scale(0.8)",display:"flex","flex-direction":"column","margin-right":"2px"}},[a("strong",{staticStyle:{"font-size":"12px","margin-top":"-8px"}},[t._v("Buyer:")]),t._v(" "+t._s(t.byr_instn_cn_full_nm)+" ")]),a("div",{staticStyle:{transform:"scale(0.8)",display:"flex","flex-direction":"column"}},[a("strong",{staticStyle:{"font-size":"12px","margin-top":"-8px"}},[t._v("Seller:")]),t._v(" "+t._s(t.slr_instn_cn_full_nm)+" ")])])],1)},Rt=[],zt=(a("cb29"),{name:"InfoCard",components:{BCard:l["a"],BCardBody:u["a"],BCardHeader:d["a"]},props:["transaction_name","bond_data"],data:function(){return{showInfoView:!1,infoViewData:null,bond_cd:null,bondData:null,byr_instn_cn_full_nm:null,slr_instn_cn_full_nm:null,byr_instn_cd:null,slr_instn_cd:null,isCardHighlighted:!1,isCardClicked:!1}},computed:Object(i["a"])(Object(i["a"])({},Object(o["d"])({})),Object(o["c"])("lassoInteraction",["getLatestSelectionBondcd","getLatestSelection","getGlobalLassoData","getGlobalHistory","getChangedTransaction","getGlobalLassoDataHistory","getHistoryActions","getHistoryIndex","getCurrentBondData"])),created:function(){},mounted:function(){this.byr_instn_cn_full_nm=this.bond_data.byr_instn_cn_full_nm,this.slr_instn_cn_full_nm=this.bond_data.slr_instn_cn_full_nm,this.byr_instn_cd=this.bond_data.byr_instn_cd,this.slr_instn_cd=this.bond_data.slr_instn_cd},methods:{sendDataToParent:function(){this.$emit("the_transaction_data",this.bond_data),console.log("the_transaction_data",this.bond_data),this.highlightCircles(this.bond_data.bond_cd)},highlightCard:function(){this.isCardHighlighted=!0},unhighlightCard:function(){this.isCardHighlighted=!1},highlightCircles:function(t){var e=Z["select"]("#svg_micro_"+t+"_2023-07-05_1");console.log("lassoContainer:",e);var a=this.bond_data.transactionId,n=Z["rgb"](174,219,155),r=Z["rgb"](255,210,186),i=e.selectAll("circle:not(.origin)"),o=i._groups[0];console.log("AllNodesList:",o);for(var s=Z["transition"]().duration(1e3).ease(Z["easeBounce"]),c=1;c<o.length-1;c++){var l=o[c],d=l.__data__.transactionId,u=d===a;l.__originalColor||(l.__originalColor={stroke:Z["select"](l).style("stroke"),strokeWidth:Z["select"](l).style("stroke-width"),fill:Z["select"](l).style("fill")});var h=l.__originalColor;u?Z["select"](l).style("stroke","red").style("stroke-width",30).style("fill",n).transition(s).style("stroke",h.fill).style("stroke-width",h.strokeWidth).style("stroke",h.stroke):Z["select"](l).style("stroke",r).style("stroke-width",1)}}}}),Et=zt,Nt=(a("d8f6"),Object(tt["a"])(Et,Gt,Rt,!1,null,"47c8e648",null)),Ft=Nt.exports,$t=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{"no-body":""}},[a("b-card",{attrs:{"no-body":""}},[a("b-card-header",{staticClass:"small-header",class:{highlighted:t.isCardHighlighted},staticStyle:{"font-size":"12px",padding:"2px 2px",height:"21px"},on:{mousedown:t.highlightCard,mouseup:t.unhighlightCard,click:function(e){return t.highlightCircles()}}},[a("div",{staticStyle:{display:"flex","margin-left":"4px"}},[t._v(" "+t._s(t.instn_cn_full_nm)+" "+t._s(t.instnType)+" ")])]),a("b-card-body",{staticStyle:{"font-size":"12px !important",padding:"2px",height:"100px",display:"flex","align-items":"left","justify-content":"left"},attrs:{id:"mg_"+t.bond_cd}},[a("div",[a("b-button-group",{staticStyle:{transform:"scale(0.8)","margin-top":"1px"},attrs:{vertical:"",size:"sm"}},[a("b-button",{staticStyle:{"background-color":"#fbb4ae"},on:{click:function(e){return t.transitionHistory(t.instn_cd,"byr_instn_cd",t.bond_cd)}}},[t._v("buy")]),a("b-button",{staticStyle:{"background-color":"#ccebc5"},on:{click:function(e){return t.transitionHistory(t.instn_cd,"slr_instn_cd",t.bond_cd)}}},[t._v("sell")])],1)],1),a("div",[a("svg",{staticStyle:{width:"100%",height:"90%"},attrs:{id:"svg_Institution_"+t.instn_cd+"_"+t.bond_cd}})])])],1)],1)},Wt=[],Yt=(a("b0c0"),{name:"InfoCard",components:{BCard:l["a"],BCardBody:u["a"],BCardHeader:d["a"],BButton:D["a"],BButtonGroup:j["a"]},props:["transaction_name","bond_data","end_date","duration_days"],data:function(){return{showInfoView:!1,infoViewData:null,bond_cd:null,bondData:null,byr_instn_cn_full_nm:null,slr_instn_cn_full_nm:null,isCardHighlighted:!1,byr_instn_cd:null,slr_instn_cd:null,instn_cd:null,instn_cn_full_nm:null,instnType:null}},computed:Object(i["a"])(Object(i["a"])({},Object(o["d"])({})),Object(o["c"])("lassoInteraction",["getLatestSelectionBondcd","getLatestSelection","getGlobalLassoData","getGlobalHistory","getChangedTransaction","getGlobalLassoDataHistory","getHistoryActions","getHistoryIndex","getCurrentBondData"])),created:function(){var t=this;b["get"]("http://localhost:5003/api/color_mapping").then((function(e){t.colorMapping=e.data})).catch((function(t){console.error("Error fetching color mapping:",t)}))},mounted:function(){this.bond_cd=this.bond_data.bond_cd,this.instn_cd=this.bond_data.instn_cd,this.instn_cn_full_nm=this.bond_data.instn_cn_full_nm,this.instnType=this.bond_data.instnType},methods:{getColor:function(t){var e=this.colorMapping[t];return e?"rgb(".concat(e[0],", ").concat(e[1],", ").concat(e[2],")"):"#fed9a6"},highlightCard:function(){this.isCardHighlighted=!0},unhighlightCard:function(){this.isCardHighlighted=!1},transitionHistory:function(t,e,a){var n=this;console.log("Buy button clicked"),console.log("bond_data:",this.bond_data),console.log("instn_cd, type, bond_cd",t,e,a),b["get"]("http://localhost:5003/api/transaction_history/".concat(t,"/").concat(e,"/").concat(a)).then((function(t){var r=e,i=t.data.json_transaction;console.log("transaction_data before:",i);var o=200,s=90,c=10,l=10,d=10,u=10;i.forEach((function(t){var e=t.timeStamp.slice(0,-6);t.timeStamp=e,t.timeStamp=new Date(t.timeStamp)}));var h=i.sort((function(t,e){return new Date(t.timeStamp)-new Date(e.timeStamp)})),m=Z["scaleTime"]().domain([Z["min"](h,(function(t){return t.timeStamp})),Z["max"](h,(function(t){return t.timeStamp}))]).range([u,o-l]),p=Z["scaleLinear"]().domain([Z["min"](h,(function(t){return t.netPrice})),Z["max"](h,(function(t){return t.netPrice}))]).range([s-d,c]),f=Z["scaleLinear"]().range([1,5]).domain([Z["min"](h,(function(t){return t.transactionVolume})),Z["max"](h,(function(t){return t.transactionVolume}))]),g=Z["line"]().curve(Z["curveCatmullRom"]).x((function(t){return m(t.timeStamp)})).y((function(t){return p(t.netPrice)}));length=function(t){return Z["create"]("svg:path").attr("d",t).node().getTotalLength()};var _=length(g(h));console.log("this.byr_instn_cd bond_cd:",n.instn_cd,a);var b=["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"],y=Z["select"]("#svg_Institution_"+n.instn_cd+"_"+a).append("svg").attr("name","Container_Institution").attr("width",o).attr("height",s);y.append("g").attr("stroke","#000").attr("stroke-opacity",.1).selectAll("circle").data(h).enter().append("circle").attr("cx",(function(t){return m(t.timeStamp)})).attr("cy",(function(t){return p(t.netPrice)})).attr("r",(function(t){return f(t.transactionVolume)})).attr("fill",(function(t){return"byr_instn_cd"===r?b[1]:b[6]})).style("opacity",.6);var v=y.append("path").datum(h).attr("fill","none").attr("stroke","byr_instn_cd"===r?b[0]:b[2]).attr("stroke-width",2.5).attr("stroke-linejoin","round").attr("stroke-linecap","round").attr("stroke-dasharray","0,".concat(_)).attr("d",g);v.transition().duration(500).ease(Z["easeLinear"]).attr("stroke-dasharray","".concat(_,",").concat(_))}))},getGraphdata:function(t,e){b["get"]("http://localhost:5003/api/graph_data/".concat(t,"/").concat(e)).then((function(t){var e=1200,a=380;console.log("response:",t.data);var n=t.data,r=n.links,i=n.nodes;console.log("nodes",i),console.log("graphdata.statistics_info",n);var o=n.statistics_info.max_total_volume_buyin,s=(n.statistics_info.max_total_volume_sell,Z["scaleOrdinal"](Z["schemeCategory10"]));function c(t,e){return Z["arc"]().innerRadius(t).outerRadius(e)}var l=Z["scaleLinear"]().domain([0,1]).range([0,2*Math.PI]),d=Z["scaleLinear"]().domain([0,Z["max"](r,(function(t){return t.volume}))]).range([10,100]),u=Z["forceSimulation"](i).force("link",Z["forceLink"](r).id((function(t){return t.id})).distance((function(t){return d(t.volume)})).strength(2)).force("charge",Z["forceManyBody"]().strength(-900)).force("center",Z["forceCenter"](e/3,a/2)).force("x",Z["forceX"]().strength(.01)).force("y",Z["forceY"]().strength(.01)).on("tick",f),h=Z["select"]("#graphView").append("svg").attr("name","Container_graphView").attr("width",e).attr("height",a).attr("viewBox",[0,0,e,a]).attr("style","max-width: 100%; height: auto;"),m=h.append("g").attr("class","link").attr("stroke","#999").attr("stroke-opacity",.6).selectAll().data(r).join("line").attr("stroke-width",(function(t){return Math.sqrt(t.volume)})),p=h.append("g").attr("class","glyph").attr("stroke","#fff").attr("stroke-width",1.5).selectAll("g").data(i).enter().append("g");function f(){m.attr("x1",(function(t){return t.source.x})).attr("y1",(function(t){return t.source.y})).attr("x2",(function(t){return t.target.x})).attr("y2",(function(t){return t.target.y})),p.attr("transform",(function(t){return"translate(".concat(t.x,",").concat(t.y,")")}))}function g(){Z["event"].active||u.alphaTarget(.3).restart(),Z["event"].subject.fx=Z["event"].subject.x,Z["event"].subject.fy=Z["event"].subject.y}function _(){Z["event"].subject.fx=Z["event"].x,Z["event"].subject.fy=Z["event"].y}function b(){Z["event"].active||u.alphaTarget(0),Z["event"].subject.fx=null,Z["event"].subject.fy=null}p.append("circle").attr("r",15).attr("fill",(function(t){return s(t.instn_tp)})),p.append("text").text((function(t){return t.name})).attr("stroke","#fbb4ae").attr("stroke-width",.5).attr("transform","translate(30, 10)"),p.append("path").attr("class","graph_arc").attr("d",(function(t){var e=t.node_global_info.buyin.total_volume;return c(20,25)({startAngle:0,endAngle:l(e/o)})})).attr("fill",(function(t){return s(t.instn_tp)})),p.call(Z["drag"]().on("start",g).on("drag",_).on("end",b))}))},getAllGraphdata:function(t){b["get"]("http://localhost:5003/api/get_global_graph_data/".concat(t)).then((function(t){var e=1200,a=380,n=t.data;console.log("response:",t.data);var r=n.links,i=n.nodes,o=Z["scaleOrdinal"](Z["schemeCategory10"]),s=Z["forceSimulation"](i).force("link",Z["forceLink"](r).id((function(t){return t.id}))).force("charge",Z["forceManyBody"]().strength(-400)).force("center",Z["forceCenter"](e/3,a/2)).force("x",Z["forceX"]()).force("y",Z["forceY"]()).on("tick",u),c=Z["select"]("#globalGraphView").attr("name","Container_all_graphView").attr("width",e).attr("height",a).attr("viewBox",[0,0,e,a]).attr("style","max-width: 100%; height: auto;"),l=c.append("g").attr("class","link").attr("stroke","#999").attr("stroke-opacity",.6).selectAll().data(r).join("line").attr("stroke-width",(function(t){return Math.sqrt(t.volume)})),d=c.append("g").attr("fill","currentColor").attr("stroke-linecap","round").attr("stroke-linejoin","round").selectAll("g").data(i).join("g");function u(){l.attr("x1",(function(t){return t.source.x})).attr("y1",(function(t){return t.source.y})).attr("x2",(function(t){return t.target.x})).attr("y2",(function(t){return t.target.y})),d.attr("transform",(function(t){return"translate(".concat(t.x,",").concat(t.y,")")}))}function h(){Z["event"].active||s.alphaTarget(.3).restart(),Z["event"].subject.fx=Z["event"].subject.x,Z["event"].subject.fy=Z["event"].subject.y}function m(){Z["event"].subject.fx=Z["event"].x,Z["event"].subject.fy=Z["event"].y}function p(){Z["event"].active||s.alphaTarget(0),Z["event"].subject.fx=null,Z["event"].subject.fy=null}d.append("circle").attr("stroke","white").attr("stroke-width",1.5).attr("r",15).attr("fill",(function(t){return o(t.instn_tp)})),d.append("text").attr("x",8).attr("y","0.31em").text((function(t){return t.name})).clone(!0).lower().attr("fill","none").attr("stroke","white").attr("stroke-width",3),d.call(Z["drag"]().on("start",h).on("drag",m).on("end",p))}))},drawHistroy:function(t,e,a){},highlightCircles:function(){var t=yt["a"].getters["lassoInteraction/getLatestSelectionBondcd"],e=Z["select"]("#svg_micro_"+t+"_2023-07-05_1"),a=Z["rgb"](174,219,155),n=Z["rgb"](255,210,186),r=e.selectAll("circle"),i=r._groups[0];console.log("AllNodesList:",i);for(var o=Z["transition"]().duration(1e3).ease(Z["easeBounce"]),s=1;s<i.length-1;s++){var c=i[s],l=c.__data__.byr_instn_cd,d=l===this.instn_cd;c.__originalColor||(c.__originalColor={stroke:Z["select"](c).style("stroke"),strokeWidth:Z["select"](c).style("stroke-width"),fill:Z["select"](c).style("fill")});var u=c.__originalColor;d?Z["select"](c).style("stroke","red").style("stroke-width",30).style("fill",a).transition(o).style("stroke",u.fill).style("stroke-width",u.strokeWidth).style("stroke",u.stroke):Z["select"](c).style("stroke",n).style("stroke-width",1)}}}}),qt=Yt,Ut=(a("c325"),Object(tt["a"])(qt,$t,Wt,!1,null,"41f16097",null)),Qt=Ut.exports,Jt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{"no-body":""}},[a("b-card",{attrs:{"no-body":""}},[a("b-card-header",{staticClass:"small-header",class:{highlighted:t.isCardHighlighted},staticStyle:{"font-size":"12px",padding:"2px 2px",height:"21px"},on:{mousedown:t.highlightCard,mouseup:t.unhighlightCard,click:function(e){return t.sendDataToParent()}}},[a("div",{staticStyle:{display:"flex","margin-left":"4px"}},[t._v(" "+t._s(t.instn_type)+" ")])]),a("b-card-body",{staticStyle:{"font-size":"12px !important",padding:"2px",height:"100px",display:"flex","align-items":"left","justify-content":"left"},attrs:{id:"mg_"+t.bond_cd}},[a("div",[a("b-button-group",{staticStyle:{transform:"scale(0.8)","margin-top":"0px"},attrs:{vertical:"",size:"sm"}},[a("b-button",{staticStyle:{},on:{click:function(e){return t.toggleDisplay(t.bond_cd)}}},[t._v(" "+t._s(t.buttonLabel)+" ")])],1)],1),a("div",[a("b-button-group",{staticStyle:{transform:"scale(0.8)","margin-top":"0px"},attrs:{vertical:"",size:"sm"}},[a("b-button",{staticStyle:{},on:{click:function(e){return t.toggleDisplayAllOnly(t.bond_cd,t.instn_type)}}},[t._v(" "+t._s(t.buttonAllOnly)+" ")])],1)],1),a("div",{staticStyle:{display:"flex","align-items":"flex-start","margin-top":"3px"}},[a("div",{staticStyle:{position:"relative"},attrs:{div:""}},[a("div",{staticStyle:{"font-size":"12px"}},[t._v("Buy volume: "+t._s(t.bond_data.buyin)+" ")]),a("div",{staticStyle:{"font-size":"12px"}},[t._v("sell volume: "+t._s(t.bond_data.sell)+" ")]),a("div",{staticStyle:{"font-size":"12px"}},[t._v("buy num: "+t._s(t.bond_data.buyinDealNum)+" ")]),a("div",{staticStyle:{"font-size":"12px"}},[t._v("sell num: "+t._s(t.bond_data.sellDealNum)+" ")]),a("div",[a("svg",{staticStyle:{width:"100%",height:"100%"},attrs:{id:"svg_Institution_type_"+t.instn_cd+"_"+t.bond_cd}},[a("rect",{staticStyle:{position:"absolute",top:"0",right:"220"},attrs:{fill:t.getColor(t.bond_data.instn_type),width:"100%",height:"10%"}})])])])])])],1)],1)},Xt=[],Kt={name:"InfoCard",components:{BCard:l["a"],BCardBody:u["a"],BCardHeader:d["a"],BButton:D["a"],BButtonGroup:j["a"]},props:["transaction_name","bond_data","end_date","duration_days"],data:function(){return{isHidden:!1,isHiddenAllOnly:!1,showInfoView:!1,infoViewData:null,bond_cd:null,bondData:null,byr_instn_cn_full_nm:null,slr_instn_cn_full_nm:null,isCardHighlighted:!1,byr_instn_cd:null,slr_instn_cd:null,instn_cd:null,instn_cn_full_nm:null,the_type_instn_list:null,instn_type:null,colorMapping:!1}},computed:Object(i["a"])(Object(i["a"])(Object(i["a"])({},Object(o["d"])({})),Object(o["c"])("lassoInteraction",["getLatestSelectionBondcd","getLatestSelection","getGlobalLassoData","getGlobalHistory","getChangedTransaction","getGlobalLassoDataHistory","getHistoryActions","getHistoryIndex","getCurrentBondData"])),{},{buttonStyle:function(){return this.isHidden?"background-color: #fed9a6":"background-color: #decbe4"},buttonLabel:function(){return this.isHidden?"Show":"Hide"},buttonAllOnly:function(){return this.isHiddenAllOnly?"All":"Only"}}),created:function(){var t=this;b["get"]("http://localhost:5003/api/color_mapping").then((function(e){t.colorMapping=e.data})).catch((function(t){console.error("Error fetching color mapping:",t)}))},mounted:function(){var t=this;console.log("this.bond_data 123",this.bond_data),this.bond_cd=yt["a"].getters["lassoInteraction/getLatestSelectionBondcd"],this.instn_cd=this.bond_data.instn_cd,this.instn_cn_full_nm=this.bond_data.instn_cn_full_nm,this.instn_type=this.bond_data.instn_type,this.$root.$on("return-all",(function(e){console.log("return-all",t.instn_type,e),console.log("this.instn_type != instn_type",t.instn_type!==e&&!0===t.isHiddenAllOnly),t.instn_type!==e&!0===t.isHiddenAllOnly&&t.nodeDisplayAllOnly(t.bond_cd,"only")}))},methods:{getColor:function(t){var e=this.colorMapping[t];return e?"rgb(".concat(e[0],", ").concat(e[1],", ").concat(e[2],")"):"#fed9a6"},sendDataToParent:function(){console.log("transaction_name",this.bond_data);var t=yt["a"].getters["lassoInteraction/getLatestSelectionBondcd"];this.highlightCircles(t)},highlightCard:function(){this.isCardHighlighted=!0},unhighlightCard:function(){this.isCardHighlighted=!1},nodeDisplayAllOnly:function(t,e){var a=Z["select"]("#svg_micro_"+t+"_2023-07-05_1"),n=this.bond_data["instn_type"];console.log("instn_tp AllNodesList:",n);var r=a.selectAll("circle:not(.origin)"),i=r._groups[0];console.log("AllNodesList:",r);for(var o=1;o<i.length-1;o++){var s=i[o],c=s.__data__.byr_instn_tp,l=c!==n;"only"===e&&l&&Z["select"](s).style("display","block"),"all"===e&&l&&Z["select"](s).style("display","none")}this.isHiddenAllOnly=!this.isHiddenAllOnly},nodeDisplay:function(t,e){var a=Z["select"]("#svg_micro_"+t+"_2023-07-05_1"),n=this.bond_data["instn_type"];console.log("instn_tp AllNodesList:",n);var r=a.selectAll("circle:not(.origin)"),i=r._groups[0];console.log("AllNodesList:",r);for(var o=1;o<i.length-1;o++){var s=i[o],c=s.__data__.byr_instn_tp,l=c===n;"show"===e&&l&&Z["select"](s).style("display","block"),"hide"===e&&l&&Z["select"](s).style("display","none")}this.isHidden=!this.isHidden},toggleDisplay:function(t){console.log("bond_cd 186",t),this.nodeDisplay(t,this.isHidden?"show":"hide")},toggleDisplayAllOnly:function(t,e){this.$root.$emit("return-all",e),console.log("bond_cd 236",t,e),console.log("bond_cd 186",t),this.nodeDisplayAllOnly(t,this.isHiddenAllOnly?"only":"all")},highlightCircles:function(t){var e=Z["select"]("#svg_micro_"+t+"_2023-07-05_1");console.log("bond_data 156",this.bond_data);var a=this.bond_data["instn_type"],n=Z["rgb"](255,210,186),r=e.selectAll("circle:not(.origin)"),i=r._groups[0];console.log("AllNodesList:",i),console.log("AllNodesList.length:",i.length-1);for(var o=Z["transition"]().duration(1e3).ease(Z["easeBounce"]),s=0;s<i.length-1;s++){var c=i[s],l=c.__data__.byr_instn_tp,d=l===a;c.__originalColor||(c.__originalColor={stroke:Z["select"](c).style("stroke"),strokeWidth:Z["select"](c).style("stroke-width"),fill:Z["select"](c).style("fill")});var u=c.__originalColor;d?Z["select"](c).style("stroke","red").style("stroke-width",30).transition(o).style("stroke",u.fill).style("stroke-width",u.strokeWidth).style("stroke",u.stroke):Z["select"](c).style("stroke",n).style("stroke-width",1)}},drawHistroy:function(t,e,a){}}},te=Kt,ee=(a("6814"),Object(tt["a"])(te,Jt,Xt,!1,null,"57fab48e",null)),ae=ee.exports,ne=Object(pt["a"])(Object(pt["a"])(Object(pt["a"])(Object(pt["a"])(Object(pt["a"])(Object(pt["a"])(Object(pt["a"])({name:"MesoView",components:{BCard:l["a"],BIcon:v["a"],BIconArrowUp:S["c"],BIconArrowDown:S["a"],BButton:D["a"],BCardHeader:d["a"],BCardBody:u["a"],BNavbar:x["a"],BDropdown:w["a"],BDropdownGroup:k["a"],BDropdownItem:B["a"],BIconGear:S["h"],BFormTags:T["a"],VueSlider:g.a,BInputGroup:C["a"],BInputGroupText:I["a"],BFormInput:M["a"],BButtonGroup:j["a"],BButtonToolbar:O["a"],InfoCard:Ft,InstitutionCard:Qt,TypeCard:ae,BTable:Zt["a"],BTabs:Pt["a"],BTab:At["a"],BSpinner:Ht["a"]},props:{sidebarStore:Object,historyStore:Object,ebm:Object,width:String,sidebarInfo:Object,sampleDataInitialized:Boolean}},"props",["end_date","duration_days"]),"data",(function(){return{bond_list:null,bondData:!1,CurrentBondData:!1,infomationList:!1,selectedbuyerseller:"buyer",selectedPriceVolume:"price",items:[{"项目":"buyer",first_name:"江苏昆山农村商业银行股份有限公司"},{"项目":"seller",first_name:"富国基金管理有限公司"},{"项目":"netPrice",first_name:"30"},{"项目":"Volume",first_name:"20"}],instn_dict:{}}})),"created",(function(){})),"computed",Object(i["a"])(Object(i["a"])(Object(i["a"])({},Object(o["d"])({})),Object(o["c"])("lassoInteraction",["getLatestSelectionBondcd","getLatestSelection","getGlobalLassoData","getGlobalHistory","getChangedTransaction","getGlobalLassoDataHistory","getHistoryActions","getHistoryIndex","getCurrentBondData"])),{},{sortCurrentTransaction:function(){var t=_.cloneDeep(this.CurrentBondData);return t.sort((function(t,e){return e.transactionVolume-t.transactionVolume})),t},sortCurrentInstn:function(){var t=this,e=_.cloneDeep(this.CurrentBondData);e.sort((function(t,e){return e.transactionVolume-t.transactionVolume}));var a=[];e.forEach((function(e){var n=a.find((function(t){return t.instn_cd===e.byr_instn_cd}));if(n)n.buyin+=e.transactionVolume;else{var r,i=null===(r=t.instn_dict[e.byr_instn_cd])||void 0===r?void 0:r.instn_tp;a.push({instn_cd:e.byr_instn_cd,instn_cn_full_nm:e.byr_instn_cn_full_nm,buyin:e.netPrice,bond_cd:e.bond_cd,sell:null,instnType:i})}var o=a.find((function(t){return t.instn_cd===e.slr_instn_cd}));if(o)o.sell+=e.transactionVolume;else{var s,c=null===(s=t.instn_dict[e.byr_instn_cd])||void 0===s?void 0:s.instn_tp;a.push({instn_cd:e.slr_instn_cd,instn_cn_full_nm:e.slr_instn_cn_full_nm,buyin:null,bond_cd:e.bond_cd,sell:e.netPrice,instnType:c})}}));var n=Object.values(a).sort((function(t,e){return e.buyin-t.buyin}));return n},sortCurrentInstnType:function(){var t=this,e=_.cloneDeep(this.CurrentBondData);e.sort((function(t,e){return e.transactionVolume-t.transactionVolume}));var a=[];e.forEach((function(e){var n,r,i=null===(n=t.instn_dict[e.byr_instn_cd])||void 0===n?void 0:n.instn_tp,o=null===(r=t.instn_dict[e.slr_instn_cd])||void 0===r?void 0:r.instn_tp,s=a.find((function(t){return t.instn_cd===e.byr_instn_cd}));s?s.buyin+=e.transactionVolume:a.push({instn_cd:e.byr_instn_cd,instn_cn_full_nm:e.byr_instn_cn_full_nm,buyin:e.transactionVolume,bond_cd:e.bond_cd,sell:null,instn_type:i});var c=a.find((function(t){return t.instn_cd===e.slr_instn_cd}));c?c.sell+=e.transactionVolume:a.push({instn_cd:e.slr_instn_cd,instn_cn_full_nm:e.slr_instn_cn_full_nm,buyin:null,bond_cd:e.bond_cd,sell:e.transactionVolume,instn_type:o})}));var n={};a.forEach((function(t){var e=t.instn_type;n.hasOwnProperty(e)?(n[e].buyin+=t.buyin||0,n[e].sell+=t.sell||0,n[e].buyinDealNum+=1,n[e].sellDealNum+=1,n[e].InstnList.push(t)):n[e]={buyin:t.buyin||0,sell:t.sell||0,instn_type:t.instn_type,InstnList:[],buyinDealNum:0,sellDealNum:0}}));var r=Object.values(n).sort((function(t,e){return e.buyin-t.buyin}));return r}})),"mounted",(function(){var t=this;b["get"]("http://localhost:5003/api/institution_types").then((function(e){var a=JSON.parse(e.data.instn_dict);t.instn_dict=a}))})),"watch",{getLatestSelectionBondcd:{handler:function(t,e){this.CurrentBondcd=yt["a"].getters["lassoInteraction/getLatestSelectionBondcd"]},deep:!0},getCurrentBondData:{handler:function(t,e){this.CurrentBondData=t["globalLassoData"]},deep:!0}}),"methods",Object(i["a"])(Object(i["a"])({},Object(o["b"])(["updateLassoSelectedTrans"])),{},{handleDataFromChild:function(t){function e(t){var e=[{Item:"ID",Info:t.transactionId},{Item:"netPrice",Info:t.netPrice},{Item:"Volume",Info:t.transactionVolume},{Item:"buyer",Info:t.byr_instn_cn_full_nm},{Item:"seller",Info:t.slr_instn_cn_full_nm},{Item:"time",Info:t.timeStamp}];return e}console.log("data 209:",t),this.infomationList=e(t)},fetchInstitutionTypes:function(){return Object(G["a"])(Object(H["a"])().mark((function t(){return Object(H["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})))()},selectChart:function(t){console.log("chartType:",t)},selectbuyerseller:function(t){console.log("chartType:",t)}})),re=ne,ie=(a("726f"),Object(tt["a"])(re,Vt,Lt,!1,null,null,null)),oe=ie.exports,se=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("b-card",{attrs:{"no-body":""}},[a("b-card-header",{staticClass:"small-header",staticStyle:{"font-size":"12px",height:"25px"}},[a("b-button",{staticStyle:{"font-size":"12px",float:"right","margin-right":"10px",padding:"0px 5px",height:"15px",display:"flex","align-items":"center"},attrs:{variant:"outline-secondary"},on:{click:function(e){return t.clearGraphView()}}},[a("i",{staticClass:"el-icon-refresh"})])],1),a("b-card-body",{staticClass:"graph_body",staticStyle:{height:"380px",padding:"5px 0px 5px 0px"}},[a("svg",{staticStyle:{height:"380px",width:"1180px"},attrs:{id:"graphView"}})])],1)],1)},ce=[],le={name:"MesoView",components:{BCard:l["a"],BIcon:v["a"],BIconArrowUp:S["c"],BIconArrowDown:S["a"],BButton:D["a"],BCardHeader:d["a"],BCardBody:u["a"],BNavbar:x["a"],BDropdown:w["a"],BDropdownGroup:k["a"],BDropdownItem:B["a"],BIconGear:S["h"],BFormTags:T["a"],VueSlider:g.a,BInputGroup:C["a"],BInputGroupText:I["a"],BFormInput:M["a"],BButtonGroup:j["a"],BButtonToolbar:O["a"]},props:[],data:function(){return{bond_list:null,scatterData:!1,lassoData:[["Arsenal",30,30],["Chelsea",50,100],["Liverpool",100,70],["Manchester City",74,140],["Manchester United",150,30],["Tottenham",203,100]]}},methods:{generateScatterData:function(){return this.lassoData},createLassoChart:function(t){var e=d3.select("#TransactionScatter").attr("width",400).attr("height",400),a=e.selectAll("circle").data(t).enter().append("circle").attr("r",4).attr("cx",(function(t){return t[1]})).attr("cy",(function(t){return t[2]})).attr("fill","steelblue"),n=function(){console.log("start"),o.items().attr("r",7).classed("not_possible",!0).classed("selected",!1)},r=function(){console.log("draw"),o.possibleItems().classed("not_possible",!1).classed("possible",!0),o.notPossibleItems().classed("not_possible",!0).classed("possible",!1)},i=function(){console.log("end"),o.items().classed("not_possible",!1).classed("possible",!1),o.selectedItems().classed("selected",!0).attr("r",7),o.notSelectedItems().attr("r",3.5)},o=d3.lasso().closePathDistance(305).closePathSelect(!0).targetArea(e).items(a).on("start",n).on("draw",r).on("end",i);return e.call(o),e.node()},clearGraphView:function(){var t=document.getElementById("graphView");while(t.firstChild)t.removeChild(t.firstChild)}},created:function(){},mounted:function(){},watch:{},computed:{}},de=le,ue=Object(tt["a"])(de,se,ce,!1,null,null,null),he=ue.exports,me=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("b-card",{attrs:{"no-body":""}},[a("b-card-header",{staticClass:"small-header",staticStyle:{"font-size":"12px",height:"25px"}},[a("b-button",{staticStyle:{"font-size":"12px",float:"right","margin-right":"10px",padding:"0px 5px",height:"15px",display:"flex","align-items":"center"},attrs:{variant:"outline-secondary"},on:{click:function(e){return t.clearGraphView()}}},[a("i",{staticClass:"el-icon-refresh"})])],1),a("b-card-body",{staticClass:"graph_body",staticStyle:{height:"380px",padding:"5px 0px 5px 0px"}},[a("svg",{staticStyle:{height:"380px",width:"1180px"},attrs:{id:"globalGraphView"}})])],1)],1)},pe=[],fe={name:"MesoView",components:{BCard:l["a"],BIcon:v["a"],BIconArrowUp:S["c"],BIconArrowDown:S["a"],BButton:D["a"],BCardHeader:d["a"],BCardBody:u["a"],BNavbar:x["a"],BDropdown:w["a"],BDropdownGroup:k["a"],BDropdownItem:B["a"],BIconGear:S["h"],BFormTags:T["a"],VueSlider:g.a,BInputGroup:C["a"],BInputGroupText:I["a"],BFormInput:M["a"],BButtonGroup:j["a"],BButtonToolbar:O["a"]},props:[],data:function(){return{bond_list:null,scatterData:!1,lassoData:[["Arsenal",30,30],["Chelsea",50,100],["Liverpool",100,70],["Manchester City",74,140],["Manchester United",150,30],["Tottenham",203,100]]}},methods:{generateScatterData:function(){return this.lassoData},createLassoChart:function(t){var e=d3.select("#TransactionScatter").attr("width",400).attr("height",400),a=e.selectAll("circle").data(t).enter().append("circle").attr("r",4).attr("cx",(function(t){return t[1]})).attr("cy",(function(t){return t[2]})).attr("fill","steelblue"),n=function(){console.log("start"),o.items().attr("r",7).classed("not_possible",!0).classed("selected",!1)},r=function(){console.log("draw"),o.possibleItems().classed("not_possible",!1).classed("possible",!0),o.notPossibleItems().classed("not_possible",!0).classed("possible",!1)},i=function(){console.log("end"),o.items().classed("not_possible",!1).classed("possible",!1),o.selectedItems().classed("selected",!0).attr("r",7),o.notSelectedItems().attr("r",3.5)},o=d3.lasso().closePathDistance(305).closePathSelect(!0).targetArea(e).items(a).on("start",n).on("draw",r).on("end",i);return e.call(o),e.node()},clearGraphView:function(){var t=document.getElementById("globalGraphView");while(t.firstChild)t.removeChild(t.firstChild)}},created:function(){},mounted:function(){},watch:{},computed:{}},ge=fe,_e=Object(tt["a"])(ge,me,pe,!1,null,null,null),be=_e.exports,ye={name:"",components:{MacroView:ut,MesoView:Ot,RecordView:oe,BSkeletonWrapper:s["a"],BSkeleton:c["a"],BCard:l["a"],BCardHeader:d["a"],BCardBody:u["a"],TradeInfoView:he,GraphInfoView:be},data:function(){return{isLoading:!0,all_bond_list:!1,selected_bond_id_list:[],selected_bond_list:[],end_date:"2023-07-05",duration_days:1,transactionSummaryData:!1,instnTypes:!1}},computed:Object(i["a"])({},Object(o["c"])(["name"])),watch:{selected_bond_id_list:function(t){var e=this;t&&(this.selected_bond_list=this.all_bond_list.filter((function(t){return e.selected_bond_id_list.includes(t.Bond_cd)})))}},created:function(){},mounted:function(){this.$root.$on("ChangeBondSelection",this.handleBondSelection),this.$root.$on("ChangeBondSelectionClose",this.handleBondSelection)},beforeDestroy:function(){this.$root.$off("ChangeBondSelection",this.handleBondSelection),this.$root.$off("ChangeBondSelectionClose",this.handleBondSelection)},methods:{fetchData:function(){var t=this;b["get"]("http://localhost:5003/api/bondSummaryData").then((function(e){t.all_bond_list=e.data.bondSummaryData,t.isLoading=!1})).catch((function(t){console.error("Error fetching bond summary data:",t)}))},handleBondSelection:function(t){this.selected_bond_id_list.includes(t)?this.selected_bond_id_list=this.selected_bond_id_list.filter((function(e){return e!==t})):this.selected_bond_id_list.push(t)},generateTransactionSummary:function(){for(var t=[],e=1;e<=50;e++){var a={Bond_cd:e,Bond_name:"Name_"+F.a.Random.string("upper",3,4),Transaction_num:F.a.Random.integer(0,2e3),Transaction_volume:F.a.Random.float(0,3e3,2,2)};t.push(a)}return t},randomDateInRange:function(){var t=new Date,e=new Date,a=F.a.Random.integer(t.getTime(),e.getTime());return new Date(a)},handleDataLoaded:function(t){this.all_bond_list=t,console.log("Received data from child component:",t)}}},ve=ye,Se=(a("5d66"),Object(tt["a"])(ve,n,r,!1,null,"28ebbac3",null));e["default"]=Se.exports},"564a":function(t,e,a){},"5d66":function(t,e,a){"use strict";a("564a")},6814:function(t,e,a){"use strict";a("42bf")},"726f":function(t,e,a){"use strict";a("bb41")},"73ad":function(t,e,a){"use strict";a("3eb4")},"913f5":function(t,e,a){"use strict";a("c7e4")},a4ac:function(t,e,a){},ba8f:function(t,e,a){"use strict";a("1ca4")},bb41:function(t,e,a){},c325:function(t,e,a){"use strict";a("d003")},c7e4:function(t,e,a){},d003:function(t,e,a){},d8f6:function(t,e,a){"use strict";a("a4ac")},f829:function(t,e,a){"use strict";a("234b")}}]);